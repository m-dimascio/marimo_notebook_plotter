<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <title>directory explorer v10</title>
    <script type="module" crossorigin src="./assets/index-g8LxgBK2.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-BVt8Dtzn.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="">import%20marimo%0A%0A__generated_with%20%3D%20%220.14.6%22%0Aapp%20%3D%20marimo.App(%0A%20%20%20%20width%3D%22columns%22%2C%0A%20%20%20%20layout_file%3D%22data%3Aapplication%2Fjson%3Bbase64%2Cew0KICAidHlwZSI6ICJncmlkIiwNCiAgImRhdGEiOiB7DQogICAgImNvbHVtbnMiOiA2LA0KICAgICJyb3dIZWlnaHQiOiAyMCwNCiAgICAibWF4V2lkdGgiOiAyNTAwLA0KICAgICJib3JkZXJlZCI6IHRydWUsDQogICAgImNlbGxzIjogWw0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBbDQogICAgICAgICAgMCwNCiAgICAgICAgICAwLA0KICAgICAgICAgIDYsDQogICAgICAgICAgMTUyDQogICAgICAgIF0sDQogICAgICAgICJzY3JvbGxhYmxlIjogdHJ1ZQ0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgInBvc2l0aW9uIjogbnVsbA0KICAgICAgfQ0KICAgIF0NCiAgfQ0KfQ%3D%3D%22%2C%0A)%0A%0A%0A%40app.cell(column%3D0)%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20os%0A%20%20%20%20from%20typing%20import%20List%2C%20Optional%2C%20Dict%2C%20Any%2C%20Tuple%0A%20%20%20%20from%20dataclasses%20import%20dataclass%0A%0A%20%20%20%20import%20pickle%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20polars%20as%20pl%0A%20%20%20%20from%20pathlib%20import%20Path%0A%20%20%20%20import%20numpy%20as%20np%0A%0A%20%20%20%20import%20plotly.express%20as%20px%0A%20%20%20%20import%20plotly.graph_objects%20as%20go%0A%20%20%20%20import%20plotly.colors%20as%20pc%0A%20%20%20%20from%20plotly_resampler%20import%20FigureResampler%20as%20FigureWidgetResampler%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20Any%2C%0A%20%20%20%20%20%20%20%20Dict%2C%0A%20%20%20%20%20%20%20%20FigureWidgetResampler%2C%0A%20%20%20%20%20%20%20%20List%2C%0A%20%20%20%20%20%20%20%20Optional%2C%0A%20%20%20%20%20%20%20%20dataclass%2C%0A%20%20%20%20%20%20%20%20go%2C%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20os%2C%0A%20%20%20%20%20%20%20%20pc%2C%0A%20%20%20%20%20%20%20%20pd%2C%0A%20%20%20%20%20%20%20%20pickle%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Column_A%3A%20Print%20Directory%20Structure%20Viewer%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(os)%3A%0A%20%20%20%20%23%20Machine%20Environment%20Configuration%0A%20%20%20%20MACHINE_ENVIRONMENTS%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22WFH%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22label%22%3A%20%22Work%20From%20Home%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22start_path%22%3A%20r%22C%3A%5CUsers%5CMichael%5CDropbox%20(Personal)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22description%22%3A%20%22Home%20office%20setup%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22PROCESS_STATION%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22label%22%3A%20%22Process%20Station%20%2F%20Automation_1%20%2F%20Automation_2%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22start_path%22%3A%20r%22C%3A%5CUsers%5Cdimas%5CDropbox%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22description%22%3A%20%22Main%20process%20automation%20stations%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22ANALOG_STATION%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22label%22%3A%20%22ANALOG-STATION-1%20%2F%20ANALOG-STATION-2%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22start_path%22%3A%20r%22C%3A%5CUsers%5CMichael%20Di%20Mascio%5CDropbox%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22description%22%3A%20%22Analog%20testing%20stations%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22SOCKET_STATION%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22label%22%3A%20%22SOCKET-STATION%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22start_path%22%3A%20r%22C%3A%5CUsers%5Crktpo%5CDropbox%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22description%22%3A%20%22Socket%20testing%20station%22%0A%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%22OTHER%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22label%22%3A%20%22Other%20%2F%20Custom%20Path%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22start_path%22%3A%20None%2C%20%20%23%20Will%20be%20manually%20entered%0A%20%20%20%20%20%20%20%20%20%20%20%20%22description%22%3A%20%22Custom%20or%20unknown%20environment%22%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20def%20detect_current_environment()%20-%3E%20str%3A%0A%20%20%20%20%20%20%20%20%22%22%22Auto-detect%20current%20machine%20environment%20based%20on%20existing%20paths%22%22%22%0A%20%20%20%20%20%20%20%20for%20env_key%2C%20env_config%20in%20MACHINE_ENVIRONMENTS.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20env_key%20%3D%3D%20%22OTHER%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20env_config%5B%22start_path%22%5D%20and%20os.path.exists(env_config%5B%22start_path%22%5D)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20env_key%0A%20%20%20%20%20%20%20%20return%20%22OTHER%22%0A%0A%20%20%20%20def%20resolve_environment_paths(selected_env%3A%20str%2C%20custom_path%3A%20str%20%3D%20%22%22)%20-%3E%20tuple%3A%0A%20%20%20%20%20%20%20%20%22%22%22Resolve%20start%20paths%20based%20on%20environment%20selection%22%22%22%0A%0A%20%20%20%20%20%20%20%20if%20selected_env%20%3D%3D%20%22OTHER%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20custom_path%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(%22Custom%20path%20required%20for%20'Other'%20environment%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20start_path%20%3D%20custom_path.strip().rstrip(%22%5C%5C%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20env_config%20%3D%20MACHINE_ENVIRONMENTS%5Bselected_env%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20start_path%20%3D%20env_config%5B%22start_path%22%5D%0A%0A%20%20%20%20%20%20%20%20%23%20Validate%20path%20exists%0A%20%20%20%20%20%20%20%20if%20not%20os.path.exists(start_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20raise%20FileNotFoundError(f%22Path%20does%20not%20exist%3A%20%7Bstart_path%7D%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Construct%20project%20paths%20using%20os.path.join%20for%20better%20path%20handling%0A%20%20%20%20%20%20%20%20sequencer_path%20%3D%20os.path.join(start_path%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22Efficiency_v2%22%2C%20%22.sequencer%22)%0A%0A%20%20%20%20%20%20%20%20sps_gui_path%20%3D%20os.path.join(start_path%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22sps_gui%22)%0A%0A%20%20%20%20%20%20%20%20return%20start_path%2C%20sequencer_path%2C%20sps_gui_path%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20MACHINE_ENVIRONMENTS%2C%0A%20%20%20%20%20%20%20%20detect_current_environment%2C%0A%20%20%20%20%20%20%20%20resolve_environment_paths%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(MACHINE_ENVIRONMENTS%2C%20detect_current_environment%2C%20mo)%3A%0A%20%20%20%20%23%20Environment%20selector%20dropdown%0A%20%20%20%20detected_env%20%3D%20detect_current_environment()%0A%0A%20%20%20%20machine_environment_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3Dlist(MACHINE_ENVIRONMENTS.keys())%2C%0A%20%20%20%20%20%20%20%20value%3Ddetected_env%2C%0A%20%20%20%20%20%20%20%20label%3D%22Select%20Machine%20Environment%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Custom%20path%20input%20(conditional)%0A%20%20%20%20custom_path_input%20%3D%20mo.ui.text(%0A%20%20%20%20%20%20%20%20placeholder%3D%22Enter%20custom%20Dropbox%20path%20(e.g.%2C%20C%3A%5C%5CUsers%5C%5Cusername%5C%5CDropbox)%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Custom%20Path%22%2C%0A%20%20%20%20%20%20%20%20value%3D%22%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Auto-detection%20status%0A%20%20%20%20env_label%20%3D%20MACHINE_ENVIRONMENTS%5Bdetected_env%5D%5B%22label%22%5D%0A%20%20%20%20detection_status%20%3D%20mo.md(f%22%F0%9F%A4%96%20**Auto-detected%3A**%20%7Benv_label%7D%22)%0A%0A%20%20%20%20return%20custom_path_input%2C%20detection_status%2C%20machine_environment_selector%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(%0A%20%20%20%20MACHINE_ENVIRONMENTS%2C%0A%20%20%20%20custom_path_input%2C%0A%20%20%20%20detection_status%2C%0A%20%20%20%20machine_environment_selector%2C%0A%20%20%20%20mo%2C%0A)%3A%0A%20%20%20%20%23%20Environment%20selection%20UI%20and%20path%20resolution%0A%20%20%20%20selected_env%20%3D%20machine_environment_selector.value%0A%20%20%20%20env_config%20%3D%20MACHINE_ENVIRONMENTS%5Bselected_env%5D%0A%0A%20%20%20%20%23%20Build%20environment%20info%20display%0A%20%20%20%20env_info_lines%20%3D%20%5B%0A%20%20%20%20%20%20%20%20f%22%23%23%20Selected%20Environment%3A%20%7Benv_config%5B'label'%5D%7D%22%2C%0A%20%20%20%20%20%20%20%20f%22**Description%3A**%20%7Benv_config%5B'description'%5D%7D%22%2C%0A%20%20%20%20%20%20%20%20%22%22%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20Show%20custom%20path%20input%20only%20for%20%22OTHER%22%20environment%0A%20%20%20%20if%20selected_env%20%3D%3D%20%22OTHER%22%3A%0A%20%20%20%20%20%20%20%20environment_ui%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20detection_status%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20machine_environment_selector%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20custom_path_input%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%5Cn%22.join(env_info_lines))%0A%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20env_info_lines.append(f%22**Path%3A**%20%60%7Benv_config%5B'start_path'%5D%7D%60%22)%0A%20%20%20%20%20%20%20%20environment_ui%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20detection_status%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20machine_environment_selector%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%5Cn%22.join(env_info_lines))%0A%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20return%20environment_ui%2C%20selected_env%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(custom_path_input%2C%20mo%2C%20resolve_environment_paths%2C%20selected_env)%3A%0A%20%20%20%20%23%20Path%20resolution%20with%20error%20handling%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20resolved_start_path%2C%20global_sequencer_path%2C%20global_sps_gui_path%20%3D%20resolve_environment_paths(%0A%20%20%20%20%20%20%20%20%20%20%20%20selected_env%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20custom_path_input.value%20if%20selected_env%20%3D%3D%20%22OTHER%22%20else%20%22%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20path_status%20%3D%20mo.md(f%22%22%22%0A%20%20%20%20%20%20%20%20%23%23%23%20%E2%9C%85%20Path%20Resolution%20Successful%0A%0A%20%20%20%20%20%20%20%20**Base%20Path%3A**%20%60%7Bresolved_start_path%7D%60%20%20%0A%20%20%20%20%20%20%20%20**Sequencer%20Path%3A**%20%60%7Bglobal_sequencer_path%7D%60%20%20%0A%20%20%20%20%20%20%20%20**SPS%20GUI%20Path%3A**%20%60%7Bglobal_sps_gui_path%7D%60%0A%20%20%20%20%20%20%20%20%22%22%22)%0A%0A%20%20%20%20%20%20%20%20print(f%22Environment%3A%20%7Bselected_env%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22Resolved%20start%20path%3A%20%7Bresolved_start_path%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22global_sequencer_path%3A%20%7Bglobal_sequencer_path%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22global_sps_gui_path%3A%20%7Bglobal_sps_gui_path%7D%22)%0A%0A%20%20%20%20except%20(ValueError%2C%20FileNotFoundError)%20as%20e%3A%0A%20%20%20%20%20%20%20%20%23%20Set%20default%20fallback%20paths%20to%20prevent%20downstream%20errors%0A%20%20%20%20%20%20%20%20resolved_start_path%20%3D%20%22%22%0A%20%20%20%20%20%20%20%20global_sequencer_path%20%3D%20%22%22%0A%20%20%20%20%20%20%20%20global_sps_gui_path%20%3D%20%22%22%0A%0A%20%20%20%20%20%20%20%20path_status%20%3D%20mo.md(f%22%22%22%0A%20%20%20%20%20%20%20%20%23%23%23%20%E2%9D%8C%20Path%20Resolution%20Error%0A%0A%20%20%20%20%20%20%20%20**Error%3A**%20%7Bstr(e)%7D%0A%0A%20%20%20%20%20%20%20%20Please%20check%20your%20environment%20selection%20or%20provide%20a%20valid%20custom%20path.%0A%20%20%20%20%20%20%20%20%22%22%22)%0A%0A%20%20%20%20%20%20%20%20print(f%22Path%20resolution%20error%3A%20%7Be%7D%22)%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20global_sequencer_path%2C%0A%20%20%20%20%20%20%20%20global_sps_gui_path%2C%0A%20%20%20%20%20%20%20%20path_status%2C%0A%20%20%20%20%20%20%20%20resolved_start_path%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(List%2C%20Optional%2C%20os)%3A%0A%20%20%20%20def%20print_directory_structure(%0A%20%20%20%20%20%20%20%20startpath%3A%20str%2C%20%0A%20%20%20%20%20%20%20%20prefix%3A%20str%20%3D%20''%2C%0A%20%20%20%20%20%20%20%20exclude_dirs%3A%20Optional%5BList%5Bstr%5D%5D%20%3D%20None%2C%0A%20%20%20%20%20%20%20%20collapse_dirs%3A%20Optional%5BList%5Bstr%5D%5D%20%3D%20None%0A%20%20%20%20)%20-%3E%20List%5Bstr%5D%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Returns%20directory%20structure%20as%20list%20of%20strings%20for%20display.%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20exclude_dirs%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20exclude_dirs%20%3D%20%5B'__pycache__'%5D%0A%20%20%20%20%20%20%20%20if%20collapse_dirs%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20collapse_dirs%20%3D%20%5B'icon'%5D%0A%0A%20%20%20%20%20%20%20%20lines%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20files%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20if%20prefix%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20prefix%20%3D%20prefix.replace('%E2%94%9C%E2%94%80%E2%94%80'%2C%20'%E2%94%82%20%20%20').replace('%E2%94%94%E2%94%80%E2%94%80'%2C%20'%20%20%20%20')%0A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20entries%20%3D%20sorted(os.listdir(startpath))%0A%20%20%20%20%20%20%20%20except%20(PermissionError%2C%20FileNotFoundError)%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%5Bf%22%7Bprefix%7D%E2%94%9C%E2%94%80%E2%94%80%20%5BError%3A%20%7Be%7D%5D%22%5D%0A%0A%20%20%20%20%20%20%20%20for%20entry%20in%20entries%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20path%20%3D%20os.path.join(startpath%2C%20entry)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20os.path.isdir(path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20entry%20in%20exclude_dirs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20entry%20in%20collapse_dirs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20item_count%20%3D%20len(os.listdir(path))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lines.append(f%22%7Bprefix%7D%E2%94%9C%E2%94%80%E2%94%80%20%7Bentry%7D%2F%20(%7Bitem_count%7D%20items)%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lines.append(f%22%7Bprefix%7D%E2%94%9C%E2%94%80%E2%94%80%20%7Bentry%7D%2F%20%5BAccess%20Denied%5D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lines.append(f%22%7Bprefix%7D%E2%94%9C%E2%94%80%E2%94%80%20%7Bentry%7D%2F%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sublines%20%3D%20print_directory_structure(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20path%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20prefix%20%2B%20'%E2%94%82%20%20%20'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20exclude_dirs%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collapse_dirs%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20lines.extend(sublines)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20files.append(entry)%0A%0A%20%20%20%20%20%20%20%20for%20i%2C%20file%20in%20enumerate(files)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20branch%20%3D%20'%E2%94%94%E2%94%80%E2%94%80%20'%20if%20i%20%3D%3D%20len(files)%20-%201%20else%20'%E2%94%9C%E2%94%80%E2%94%80%20'%0A%20%20%20%20%20%20%20%20%20%20%20%20lines.append(f%22%7Bprefix%7D%7Bbranch%7D%7Bfile%7D%22)%0A%0A%20%20%20%20%20%20%20%20return%20lines%0A%0A%20%20%20%20return%20(print_directory_structure%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(global_sequencer_path%2C%20global_sps_gui_path%2C%20os)%3A%0A%20%20%20%20%23%20Define%20the%20package%20directory%20global_package_paths%0A%20%20%20%20global_package_paths%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22sequencer%22%3A%20global_sequencer_path%2C%0A%20%20%20%20%20%20%20%20%22sps_gui%22%3A%20global_sps_gui_path%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%20Check%20if%20global_package_paths%20exist%0A%20%20%20%20for%20name%2C%20path%20in%20global_package_paths.items()%3A%0A%20%20%20%20%20%20%20%20if%20path%20and%20os.path.exists(path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9C%85%20%7Bname%7D%3A%20%7Bpath%7D%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9D%8C%20%7Bname%7D%3A%20%7Bpath%7D%20(not%20found%20or%20invalid)%22)%0A%0A%20%20%20%20return%20(global_package_paths%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20Simple%20UI%20for%20directory%20selection%0A%20%20%20%20package_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20options%3D%5B%22sequencer%22%2C%20%22sps_gui%22%2C%20%22both%22%5D%2C%0A%20%20%20%20%20%20%20%20value%3D%22sequencer%22%2C%0A%20%20%20%20%20%20%20%20label%3D%22Select%20Package%20to%20Explore%22%0A%20%20%20%20)%0A%0A%20%20%20%20return%20(package_selector%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(%0A%20%20%20%20global_package_paths%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20os%2C%0A%20%20%20%20package_selector%2C%0A%20%20%20%20print_directory_structure%2C%0A)%3A%0A%20%20%20%20%23%20Explore%20the%20selected%20directory%0A%20%20%20%20if%20not%20package_selector.value%3A%0A%20%20%20%20%20%20%20%20directory_output%20%3D%20mo.md(%22Please%20select%20a%20package.%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20output_lines%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20def%20explore_single_package(pkg_name)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20pkg_name%20not%20in%20global_package_paths%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%5Bf%22%E2%9D%8C%20Package%20'%7Bpkg_name%7D'%20not%20configured%22%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20pkg_path%20%3D%20global_package_paths%5Bpkg_name%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20pkg_path%20or%20not%20os.path.exists(pkg_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%5Bf%22%E2%9D%8C%20Directory%20not%20found%3A%20%7Bpkg_path%7D%22%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20lines%20%3D%20%5Bf%22%23%23%20%7Bpkg_name.upper()%7D%20Directory%20Structure%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20lines.append(f%22**Path%3A**%20%60%7Bpkg_path%7D%60%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20lines.append(%22%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20lines.append(%22%60%60%60%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20structure_lines%20%3D%20print_directory_structure(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pkg_path%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20exclude_dirs%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'__pycache__'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.git'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.pytest_cache'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'sps_gui.egg-info'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'sequencer.egg-info'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'docs'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'examples'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.venv'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.venv2'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.venv3'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.venv4'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.archive'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.vscode'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.claude'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collapse_dirs%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'icon'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'logs'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'data'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'backup'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'_script_testing'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'Auto_Data'%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'_del_test'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'cli'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'core_readmes'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'config'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'.ALL'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'tests'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'Tracker_Data'%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20lines.extend(structure_lines)%0A%20%20%20%20%20%20%20%20%20%20%20%20lines.append(%22%60%60%60%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20lines.append(%22%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20lines%0A%0A%20%20%20%20%20%20%20%20if%20package_selector.value%20%3D%3D%20%22both%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20pkg%20in%20%5B%22sequencer%22%2C%20%22sps_gui%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output_lines.extend(explore_single_package(pkg))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20output_lines.append(%22---%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20output_lines.extend(explore_single_package(package_selector.value))%0A%0A%20%20%20%20%20%20%20%20directory_output%20%3D%20mo.md(%22%5Cn%22.join(output_lines))%0A%0A%20%20%20%20return%20(directory_output%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(directory_output%2C%20environment_ui%2C%20mo%2C%20package_selector%2C%20path_status)%3A%0A%20%20%20%20%23%20Main%20layout%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%20Package%20Directory%20Explorer%20v10%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22Multi-environment%20directory%20structure%20explorer%20with%20enhanced%20tm_scope%20individual%20trace%20%2B%20bulk%20selection%20controls%20%2B%20dynamic%20wafer%20discovery%20%26%20push-button%20filtering.%22)%2C%0A%20%20%20%20%20%20%20%20environment_ui%2C%0A%20%20%20%20%20%20%20%20path_status%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20package_selector%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20directory_output%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D1%2C%20hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Column_B%3A%20Duty%20Cycles%20to%20Dataframe%20Viewer%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%23%23%20Adding%20sequencer.config%20path%0A%20%20%20%20%23%23%23%20sequencer.config.loaded_duty_dict%20import%20loaded_duty_dict%0A%20%20%20%20%23%23%23%20sequencer.config.pyconfig_pickle%0A%20%20%20%20%23%23%23%20sequencer.resources.config.RTK_duty_cycles.pkl%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(global_package_paths%2C%20os%2C%20resolved_start_path)%3A%0A%20%20%20%20%23%20contains%20the%20dataframe%20processing%20and%20pickle%20functions%0A%20%20%20%20if%20resolved_start_path%20and%20os.path.isdir(resolved_start_path)%3A%0A%20%20%20%20%20%20%20%20%23%20Use%20os.path.join%20for%20better%20path%20construction%0A%20%20%20%20%20%20%20%20global_package_paths%5B'sequencer.config'%5D%20%3D%20os.path.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20resolved_start_path%2C%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22Efficiency_v2%22%2C%20%22.sequencer%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22src%22%2C%20%22sequencer%22%2C%20%22config%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20contains%20the%20dataframe%20pickle%20files%2C%20sequencer%5C%5Cresources%5C%5Cconfig%5C%5Cpyconfig_pickle.py%0A%20%20%20%20%20%20%20%20global_package_paths%5B'sequencer.resources.config'%5D%20%3D%20os.path.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20resolved_start_path%2C%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22Efficiency_v2%22%2C%20%22.sequencer%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22src%22%2C%20%22sequencer%22%2C%20%22resources%22%2C%20%22config%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20global_package_paths%5B'sequencer.core.Auto_Data'%5D%20%3D%20os.path.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20resolved_start_path%2C%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22Efficiency_v2%22%2C%20%22.sequencer%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22src%22%2C%20%22sequencer%22%2C%20%22core%22%2C%20%22Auto_Data%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print(f%22resolved_start_path%3D%5Cn%7Bresolved_start_path%7D%20%5Cnis%20invalid%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(global_package_paths%2C%20mo%2C%20os%2C%20selected_env)%3A%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20if%20'sequencer.config'%20in%20global_package_paths%20and%20os.path.isdir(global_package_paths%5B'sequencer.config'%5D)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%22%F0%9F%93%81%20Sequencer%20paths%20configured%3A%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20Config%3A%20%7Bglobal_package_paths%5B'sequencer.config'%5D%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20Resources%3A%20%7Bglobal_package_paths%5B'sequencer.resources.config'%5D%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20Auto_Data%3A%20%7Bglobal_package_paths%5B'sequencer.core.Auto_Data'%5D%7D%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20validation_message%20%3D%20mo.md(f%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%23%23%20%E2%9A%A0%EF%B8%8F%20Path%20Validation%20Warning%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20**Environment%3A**%20%7Bselected_env%7D%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20**Issue%3A**%20Sequencer%20paths%20are%20not%20accessible%20or%20invalid%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20Please%20verify%20your%20environment%20selection%20and%20ensure%20the%20paths%20exist.%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print('Environment%20paths%20are%20invalid.%20Check%20environment%20selection.')%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22Selected%20environment%3A%20%7Bselected_env%7D%22)%0A%20%20%20%20except%20KeyError%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f%22No%20key%20found%20for%20global_package_paths%2C%20%5Cn%7Be%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(os)%3A%0A%20%20%20%20%23%20Pickle%20file%20discovery%20and%20UI%0A%20%20%20%20def%20discover_pickle_files(base_path)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Discover%20all%20pickle%20files%20in%20the%20sequencer%20resources%20directory%22%22%22%0A%20%20%20%20%20%20%20%20pickle_files%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20if%20not%20base_path%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20pickle_files%0A%0A%20%20%20%20%20%20%20%20config_path%20%3D%20os.path.join(base_path%2C%20%22resources%22%2C%20%22config%22)%0A%0A%20%20%20%20%20%20%20%20if%20os.path.exists(config_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20file%20in%20os.listdir(config_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20file.endswith('.pkl')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20full_path%20%3D%20os.path.join(config_path%2C%20file)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pickle_files.append(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'name'%3A%20file%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'path'%3A%20full_path%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'size'%3A%20os.path.getsize(full_path)%20if%20os.path.exists(full_path)%20else%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D)%0A%0A%20%20%20%20%20%20%20%20return%20sorted(pickle_files%2C%20key%3Dlambda%20x%3A%20x%5B'name'%5D)%0A%0A%20%20%20%20return%20(discover_pickle_files%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(discover_pickle_files%2C%20os%2C%20resolved_start_path)%3A%0A%20%20%20%20%23%20Get%20sequencer%20base%20path%20and%20discover%20pickle%20files%0A%20%20%20%20if%20resolved_start_path%3A%0A%20%20%20%20%20%20%20%20sequencer_base%20%3D%20os.path.join(%0A%20%20%20%20%20%20%20%20%20%20%20%20resolved_start_path%2C%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22Efficiency_v2%22%2C%20%22.sequencer%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22src%22%2C%20%22sequencer%22%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20sequencer_base%20%3D%20%22%22%0A%0A%20%20%20%20pickle_files%20%3D%20discover_pickle_files(sequencer_base)%0A%0A%20%20%20%20%23%20Display%20discovered%20files%0A%20%20%20%20if%20pickle_files%3A%0A%20%20%20%20%20%20%20%20print(%22%F0%9F%93%81%20Discovered%20Pickle%20Files%3A%22)%0A%20%20%20%20%20%20%20%20for%20pf%20in%20pickle_files%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20size_kb%20%3D%20pf%5B'size'%5D%20%2F%201024%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%E2%80%A2%20%7Bpf%5B'name'%5D%7D%20(%7Bsize_kb%3A.1f%7D%20KB)%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print(%22%E2%9D%8C%20No%20pickle%20files%20found%22)%0A%0A%20%20%20%20return%20(pickle_files%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo%2C%20pickle_files)%3A%0A%20%20%20%20%23%20Create%20UI%20for%20pickle%20file%20selection%0A%20%20%20%20if%20pickle_files%3A%0A%20%20%20%20%20%20%20%20pickle_options%20%3D%20%5Bpf%5B'name'%5D%20for%20pf%20in%20pickle_files%5D%0A%20%20%20%20%20%20%20%20pickle_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dpickle_options%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3Dpickle_options%5B0%5D%20if%20pickle_options%20else%20None%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Select%20Pickle%20File%20to%20View%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20load_button%20%3D%20mo.ui.button(%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Load%20Selected%20Pickle%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20kind%3D%22success%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20on_click%3Dlambda%20value%3A%20value*-1%2C%20%20%23%20toggle%20positive%2Fnegative%20with%20click%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20pickle_ui%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20Pickle%20File%20Selection%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20pickle_selector%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20load_button%2C%0A%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Create%20dummy%20components%20to%20maintain%20Marimo%20variable%20consistency%0A%20%20%20%20%20%20%20%20pickle_selector%20%3D%20mo.ui.dropdown(options%3D%5B%22No%20files%22%5D%2C%20value%3D%22No%20files%22%2C%20label%3D%22No%20pickle%20files%20available%22)%0A%20%20%20%20%20%20%20%20load_button%20%3D%20mo.ui.button(label%3D%22No%20files%20to%20load%22%2C%20disabled%3DTrue)%0A%20%20%20%20%20%20%20%20pickle_ui%20%3D%20mo.md(%22%E2%9D%8C%20No%20pickle%20files%20available%20for%20selection%22)%0A%0A%20%20%20%20return%20load_button%2C%20pickle_selector%2C%20pickle_ui%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(pickle_selector)%3A%0A%20%20%20%20if%20hasattr(pickle_selector%2C%20'value')%20and%20pickle_selector.value%3A%0A%20%20%20%20%20%20%20%20print(f%22Selected%20file%3A%20%7Bpickle_selector.value%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(pickle_ui)%3A%0A%20%20%20%20pickle_ui%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(load_button%2C%20pickle_selector)%3A%0A%20%20%20%20print(f%22%F0%9F%94%8D%20Debug%3A%20Button%20value%20%3D%20%7Bload_button.value%7D%22)%0A%20%20%20%20print(f%22%F0%9F%94%8D%20Debug%3A%20Selected%20file%20%3D%20%7Bpickle_selector.value%20if%20hasattr(pickle_selector%2C%20'value')%20else%20'None'%7D%22)%0A%20%20%20%20print(f%22%F0%9F%94%8D%20Debug%3A%20Button%20clicked%20%3D%20%7Bload_button.value%20is%20not%20None%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(load_button%2C%20pd%2C%20pickle%2C%20pickle_files%2C%20pickle_selector)%3A%0A%20%20%20%20%23%20Get%20keys%20organized%20by%20layer%2Fdepth%20for%20dictionary%20structure%0A%20%20%20%20def%20private_get_keys_by_layer(d%2C%20layer%3D0%2C%20result%3DNone)%3A%0A%20%20%20%20%20%20%20%20if%20result%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20result%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20if%20isinstance(d%2C%20dict)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20layer%20not%20in%20result%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%5Blayer%5D%20%3D%20set()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20key%2C%20value%20in%20d.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20result%5Blayer%5D.add(key)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20private_get_keys_by_layer(value%2C%20layer%20%2B%201%2C%20result)%0A%0A%20%20%20%20%20%20%20%20return%20result%0A%0A%20%20%20%20%23%20Load%20selected%20pickle%20file%20when%20button%20is%20clicked%20(value%20changes)%0A%20%20%20%20if%20(load_button.value%20%3E%200%20and%20%0A%20%20%20%20%20%20%20%20hasattr(pickle_selector%2C%20'value')%20and%20%0A%20%20%20%20%20%20%20%20pickle_selector.value%20and%20%0A%20%20%20%20%20%20%20%20pickle_selector.value%20!%3D%20%22No%20files%22)%3A%0A%0A%20%20%20%20%20%20%20%20selected_file%20%3D%20next((pf%20for%20pf%20in%20pickle_files%20if%20pf%5B'name'%5D%20%3D%3D%20pickle_selector.value)%2C%20None)%0A%0A%20%20%20%20%20%20%20%20if%20selected_file%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20with%20open(selected_file%5B'path'%5D%2C%20'rb')%20as%20f%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20global_loaded_data%20%3D%20pickle.load(f)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Store%20metadata%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pickle_metadata%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'filename'%3A%20selected_file%5B'name'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'path'%3A%20selected_file%5B'path'%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'data_type'%3A%20type(global_loaded_data).__name__%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'size_kb'%3A%20selected_file%5B'size'%5D%20%2F%201024%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'load_count'%3A%20load_button.value%20%20%23%20Track%20how%20many%20times%20loaded%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9C%85%20Successfully%20loaded%3A%20%7Bselected_file%5B'name'%5D%7D%20(Load%20%23%7Bload_button.value%7D)%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%93%8A%20Data%20type%3A%20%7Btype(global_loaded_data).__name__%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Try%20to%20get%20more%20info%20about%20the%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20isinstance(global_loaded_data%2C%20dict)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20keys_by_layer%20%3D%20private_get_keys_by_layer(global_loaded_data)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20layer%2C%20keys%20in%20keys_by_layer.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%94%91%20Layer%20%7Blayer%7D%20keys%3A%20%7Blist(keys)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20isinstance(global_loaded_data%2C%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%93%88%20DataFrame%20shape%3A%20%7Bglobal_loaded_data.shape%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%93%8B%20Columns%3A%20%7Blist(global_loaded_data.columns)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20isinstance(global_loaded_data%2C%20(list%2C%20tuple))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%93%9D%20Length%3A%20%7Blen(global_loaded_data)%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20global_loaded_data%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pickle_metadata%20%3D%20%7B'error'%3A%20str(e)%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9D%8C%20Error%20loading%20%7Bselected_file%5B'name'%5D%7D%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20global_loaded_data%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20pickle_metadata%20%3D%20%7B%7D%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20global_loaded_data%20%3D%20None%0A%20%20%20%20%20%20%20%20pickle_metadata%20%3D%20%7B%7D%0A%0A%20%20%20%20return%20global_loaded_data%2C%20pickle_metadata%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(global_loaded_data%2C%20mo%2C%20pd%2C%20pickle_metadata)%3A%0A%20%20%20%20%23%20Display%20loaded%20data%20information%20and%20preview%0A%20%20%20%20if%20global_loaded_data%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20info_lines%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22%23%23%20%F0%9F%93%81%20%7Bpickle_metadata.get('filename'%2C%20'Unknown')%7D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22**Type%3A**%20%7Bpickle_metadata.get('data_type'%2C%20'Unknown')%7D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20f%22**Size%3A**%20%7Bpickle_metadata.get('size_kb'%2C%200)%3A.1f%7D%20KB%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%0A%20%20%20%20%20%20%20%20%5D%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20preview%20based%20on%20data%20type%0A%20%20%20%20%20%20%20%20if%20isinstance(global_loaded_data%2C%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20info_lines.extend(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22**Shape%3A**%20%7Bglobal_loaded_data.shape%5B0%5D%7D%20rows%20%C3%97%20%7Bglobal_loaded_data.shape%5B1%5D%7D%20columns%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22**Columns%3A**%20%7B'%2C%20'.join(global_loaded_data.columns)%7D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%23%23%23%20Data%20Preview%20(First%205%20rows)%3A%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20preview_table%20%3D%20mo.ui.table(global_loaded_data.head())%0A%20%20%20%20%20%20%20%20%20%20%20%20data_info%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%5Cn%22.join(info_lines))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20preview_table%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20%20%20%20%20elif%20isinstance(global_loaded_data%2C%20dict)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20info_lines.extend(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22**Keys%3A**%20%7Blen(global_loaded_data)%7D%20items%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%23%23%23%20Dictionary%20Structure%3A%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Check%20if%20this%20is%20a%20duty%20cycle%20dictionary%0A%20%20%20%20%20%20%20%20%20%20%20%20_is_duty_dict%20%3D%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_first_key%20%3D%20next(iter(global_loaded_data))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20isinstance(global_loaded_data%5B_first_key%5D%2C%20dict)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_second_level%20%3D%20global_loaded_data%5B_first_key%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_second_key%20%3D%20next(iter(_second_level))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20isinstance(_second_level%5B_second_key%5D%2C%20dict)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_is_duty_dict%20%3D%20True%0A%20%20%20%20%20%20%20%20%20%20%20%20except%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20_is_duty_dict%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Special%20handling%20for%20duty%20cycle%20dictionaries%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview%20%3D%20%5B%22This%20appears%20to%20be%20a%20**Duty%20Cycle%20Dictionary**%20with%20structure%3A%22%2C%20%22%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(%22%60%60%60%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(%22duty_dict%5BVOUT%5D%5BPVIN%5D%5BLOAD%5D%20%3D%20duty_cycle%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(%22%60%60%60%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(%22%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Show%20available%20VOUT%20values%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_vout_values%20%3D%20sorted(global_loaded_data.keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(f%22**VOUT%20values%3A**%20%7B'%2C%20'.join(%5Bf'%7Bv%7DV'%20for%20v%20in%20_vout_values%5D)%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Show%20PVIN%20values%20for%20first%20VOUT%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_first_vout%20%3D%20_vout_values%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_pvin_values%20%3D%20sorted(global_loaded_data%5B_first_vout%5D.keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(f%22**PVIN%20values%20(for%20VOUT%3D%7B_first_vout%7DV)%3A**%20%7B'%2C%20'.join(%5Bf'%7Bv%7DV'%20for%20v%20in%20_pvin_values%5D)%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Show%20load%20values%20for%20first%20VOUT%2FPVIN%20combination%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_first_pvin%20%3D%20_pvin_values%5B0%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_load_values%20%3D%20sorted(global_loaded_data%5B_first_vout%5D%5B_first_pvin%5D.keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(f%22**Load%20values%3A**%20%7B'%2C%20'.join(%5Bf'%7Bv%7DA'%20for%20v%20in%20_load_values%5D)%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Show%20sample%20duty%20cycle%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20_sample_duty%20%3D%20global_loaded_data%5B_first_vout%5D%5B_first_pvin%5D%5B_load_values%5B0%5D%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(f%22**Sample%20duty%20cycle%3A**%20%7B_sample_duty%3A.2f%7D%25%20(at%20VOUT%3D%7B_first_vout%7DV%2C%20PVIN%3D%7B_first_pvin%7DV%2C%20Load%3D%7B_load_values%5B0%5D%7DA)%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Regular%20dictionary%20preview%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20key%2C%20value%20in%20list(global_loaded_data.items())%5B%3A10%5D%3A%20%20%23%20Show%20first%2010%20items%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value_type%20%3D%20type(value).__name__%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20isinstance(value%2C%20(list%2C%20dict%2C%20tuple))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value_summary%20%3D%20f%22%7Bvalue_type%7D%20(length%3A%20%7Blen(value)%7D)%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20elif%20isinstance(value%2C%20pd.DataFrame)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value_summary%20%3D%20f%22DataFrame%20%7Bvalue.shape%7D%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20value_summary%20%3D%20f%22%7Bvalue_type%7D%3A%20%7Bstr(value)%5B%3A50%5D%7D...%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(f%22-%20**%7Bkey%7D**%3A%20%7Bvalue_summary%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(global_loaded_data)%20%3E%2010%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dict_preview.append(f%22...%20and%20%7Blen(global_loaded_data)%20-%2010%7D%20more%20items%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20info_lines.extend(dict_preview)%0A%20%20%20%20%20%20%20%20%20%20%20%20data_info%20%3D%20mo.md(%22%5Cn%22.join(info_lines))%0A%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20info_lines.extend(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%23%23%23%20Raw%20Data%20Preview%3A%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f%22%60%60%60%5Cn%7Bstr(global_loaded_data)%5B%3A500%5D%7D%7B'...'%20if%20len(str(global_loaded_data))%20%3E%20500%20else%20''%7D%5Cn%60%60%60%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20data_info%20%3D%20mo.md(%22%5Cn%22.join(info_lines))%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20if%20pickle_metadata%20and%20'error'%20in%20pickle_metadata%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20data_info%20%3D%20mo.md(f%22%E2%9D%8C%20**Error%3A**%20%7Bpickle_metadata%5B'error'%5D%7D%22)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20data_info%20%3D%20mo.md(%22Select%20and%20load%20a%20pickle%20file%20to%20view%20its%20contents.%22)%0A%0A%20%20%20%20return%20(data_info%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(data_info)%3A%0A%20%20%20%20data_info%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D2%2C%20hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Column_C%3A%20CWD%20Paths%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(global_package_paths)%3A%0A%20%20%20%20print(global_package_paths.keys())%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(global_package_paths%2C%20global_sequencer_path%2C%20global_sps_gui_path)%3A%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20print(f%22global_sequencer_path%3A%5Cn%20%7Bglobal_sequencer_path%7D%5Cn%22)%0A%20%20%20%20%20%20%20%20print(f%22global_sps_gui_path%3A%5Cn%20%7Bglobal_sps_gui_path%7D%5Cn%22)%0A%0A%20%20%20%20%20%20%20%20if%20'sequencer.config'%20in%20global_package_paths%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22sequencer.config%20path%3A%5Cn%20%7Bglobal_package_paths%5B'sequencer.config'%5D%7D%5Cn%22)%0A%0A%20%20%20%20%20%20%20%20print(%22%23---------%20Location%20for%20duty_cycle%20dictionary%20pickle%20files%20---------%23%22)%0A%20%20%20%20%20%20%20%20if%20'sequencer.resources.config'%20in%20global_package_paths%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22sequencer.resources.config%20path%3A%5Cn%20%7Bglobal_package_paths%5B'sequencer.resources.config'%5D%7D%5Cn%22)%0A%0A%20%20%20%20%20%20%20%20print(%22%23---------%20Location%20for%20Auto_Data%20---------%23%22)%0A%20%20%20%20%20%20%20%20if%20'sequencer.core.Auto_Data'%20in%20global_package_paths%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22sequencer.core.Auto_Data%20path%3A%5Cn%20%7Bglobal_package_paths%5B'sequencer.core.Auto_Data'%5D%7D%22)%0A%20%20%20%20except%20KeyError%20as%20e%3A%0A%20%20%20%20%20%20%20%20print(f%22No%20key%20found.%5Cn%7Be%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D3%2C%20hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Column_D%3A%20Generate%20New%20Duty%20Cycle%20Dictionaries%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20global_package_paths%5B'sequencer.resources.config'%5D%0A%20%20%20%20%23%20TODO%2020250528%20-%20need%20to%20create%20a%20function%20that%20creates%20a%20new%20pkl%20file%20in%20above%20location%20and%20prepends%20marimo_%7Bpkl_filename%7D%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20this%20should%20be%20a%20copy%20of%20TC3-A5-1_test2_update.pkl%2C%20but%20has%20additional%20VOUT%3D0.8V%20dataseries%20up%20to%2060A%0A%20%20%20%20%23%20TODO%2020250528%20-%20need%20to%20create%20an%20object%20that%20maps%20CONDITIONS%20to%20a%20dutycycle_vs_load%20equation%0A%20%20%20%20%23%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20-%20utilize%20MPS_df_750-1500khz.html%20%2F%20MPS_df_750-1500khz_duty_cycles.pkl%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D4%2C%20hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Column_E%3A%20tm_scope%20Directory%20Navigation%20%26%20File%20Discovery%20(v10%3A%20Dynamic%20Wafer%20Discovery)%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Dynamic%20Wafer%20Directory%20Navigation%20and%20File%20Discovery%20(v10%20Enhancement)%0A%0A%20%20%20%20Discover%20and%20validate%20tm_scope%20Excel%20files%20across%20multiple%20wafer%20directories%20with%20automatic%20detection.%0A%0A%20%20%20%20**Enhanced%20Target%20Structure%20(v10)%3A**%0A%20%20%20%20-%20tm_scope_data%2F%5BWAFER_DIR%5D%2F%5BVOUT%5D%2F%5BCBOOT%5D%2FExcel_files%0A%20%20%20%20-%20WAFER%20directories%3A%20Wave1Wafer3_A0-V1%2C%20Wave2WaferX_A1-V1%2C%20etc.%20(dynamically%20discovered)%0A%20%20%20%20-%20VOUT%20conditions%3A%200.8VOUT%2C%201.8VOUT%2C%20etc.%0A%20%20%20%20-%20CBOOT%20values%3A%200.1%2C%200.22%2C%200.47%20(%CE%BCF)%0A%0A%20%20%20%20**v10%20Enhancements%3A**%0A%20%20%20%20-%20Dynamic%20wafer%20directory%20discovery%0A%20%20%20%20-%20Support%20for%20unlimited%20wafer%20types%0A%20%20%20%20-%20Enhanced%20data%20hierarchy%3A%20WAFER%20%3E%20VOUT%20%3E%20CBOOT%20%3E%20SW%2FPH%20%3E%20LOAD%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(Any%2C%20Dict%2C%20List%2C%20os%2C%20resolved_start_path)%3A%0A%20%20%20%20%23%20Column%20E%3A%20Dynamic%20Wafer%20Directory%20Navigation%20and%20File%20Discovery%20(v10)%0A%20%20%20%20def%20discover_tm_scope_files_dynamic(base_path%3A%20str)%20-%3E%20Dict%5Bstr%2C%20Dict%5Bstr%2C%20Dict%5Bstr%2C%20List%5Bstr%5D%5D%5D%5D%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Discover%20tm_scope%20Excel%20files%20across%20multiple%20wafer%20directories%20(v10%20Enhancement)%0A%0A%20%20%20%20%20%20%20%20Returns%3A%20%7Bwafer_dir%3A%20%7Bvout_dir%3A%20%7Bcboot_dir%3A%20%5Bfiles%5D%7D%7D%7D%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20base_path%20or%20not%20os.path.exists(base_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20%23%20Construct%20tm_scope_data%20path%0A%20%20%20%20%20%20%20%20tm_scope_path%20%3D%20os.path.join(base_path%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22sps_gui%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%22src%22%2C%20%22sps_gui%22%2C%20%22utils%22%2C%20%22notebooks%22%2C%20%22tm_scope_data%22)%0A%0A%20%20%20%20%20%20%20%20if%20not%20os.path.exists(tm_scope_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9D%8C%20tm_scope_data%20directory%20not%20found%3A%20%7Btm_scope_path%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20discovered_files%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20%23%20Dynamically%20discover%20all%20wafer%20directories%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wafer_dirs%20%3D%20%5Bd%20for%20d%20in%20os.listdir(tm_scope_path)%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20os.path.isdir(os.path.join(tm_scope_path%2C%20d))%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20and%20('Wave'%20in%20d%20or%20'wafer'%20in%20d.lower())%5D%0A%20%20%20%20%20%20%20%20except%20(PermissionError%2C%20OSError)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9D%8C%20Error%20accessing%20tm_scope_data%20directory%3A%20%7Btm_scope_path%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20if%20not%20wafer_dirs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9D%8C%20No%20wafer%20directories%20found%20in%3A%20%7Btm_scope_path%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20print(f%22%F0%9F%94%8D%20Found%20%7Blen(wafer_dirs)%7D%20wafer%20directories%3A%20%7Bwafer_dirs%7D%22)%0A%0A%20%20%20%20%20%20%20%20for%20wafer_dir%20in%20wafer_dirs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wafer_path%20%3D%20os.path.join(tm_scope_path%2C%20wafer_dir)%0A%20%20%20%20%20%20%20%20%20%20%20%20discovered_files%5Bwafer_dir%5D%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%F0%9F%93%82%20Processing%20wafer%20directory%3A%20%7Bwafer_dir%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Scan%20for%20VOUT%20directories%20within%20each%20wafer%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vout_dirs%20%3D%20%5Bd%20for%20d%20in%20os.listdir(wafer_path)%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20os.path.isdir(os.path.join(wafer_path%2C%20d))%20and%20'VOUT'%20in%20d%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20(PermissionError%2C%20OSError)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%E2%9D%8C%20Error%20accessing%20wafer%20directory%3A%20%7Bwafer_path%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_dir%20in%20vout_dirs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vout_path%20%3D%20os.path.join(wafer_path%2C%20vout_dir)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20discovered_files%5Bwafer_dir%5D%5Bvout_dir%5D%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Scan%20for%20CBOOT%20subdirectories%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_dirs%20%3D%20%5Bd%20for%20d%20in%20os.listdir(vout_path)%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20os.path.isdir(os.path.join(vout_path%2C%20d))%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20(PermissionError%2C%20OSError)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_dir%20in%20cboot_dirs%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Skip%20.ALL%20directories%20during%20discovery%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cboot_dir.startswith('.')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_path%20%3D%20os.path.join(vout_path%2C%20cboot_dir)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20excel_files%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20file_name%20in%20os.listdir(cboot_path)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20file_name.endswith('.xlsx')%20and%20not%20file_name.startswith('~')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20excel_files.append(file_name)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20(PermissionError%2C%20OSError)%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%E2%9D%8C%20Error%20accessing%20%7Bcboot_path%7D%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20excel_files%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20discovered_files%5Bwafer_dir%5D%5Bvout_dir%5D%5Bcboot_dir%5D%20%3D%20sorted(excel_files)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Check%20for%20direct%20files%20in%20VOUT%20directory%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20direct_files%20%3D%20%5Bf%20for%20f%20in%20os.listdir(vout_path)%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20f.endswith('.xlsx')%20and%20not%20f.startswith('~')%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20direct_files%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20discovered_files%5Bwafer_dir%5D%5Bvout_dir%5D%5B%22direct%22%5D%20%3D%20sorted(direct_files)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20(PermissionError%2C%20OSError)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20%20%20%20%20return%20discovered_files%0A%0A%20%20%20%20def%20validate_file_structure_with_wafers(discovered_files%3A%20Dict)%20-%3E%20Dict%5Bstr%2C%20Any%5D%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Validate%20file%20accessibility%20and%20extract%20wafer-level%20metadata%20(v10%20Enhancement)%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20validation_results%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20'total_files'%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'wafer_directories'%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'vout_conditions'%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'cboot_values'%3A%20%5B%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'wafer_metadata'%3A%20%7B%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20'errors'%3A%20%5B%5D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20for%20wafer_key%2C%20wafer_data%20in%20discovered_files.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'wafer_directories'%5D.append(wafer_key)%0A%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'vout_conditions'%3A%20set()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'cboot_values'%3A%20set()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'file_count'%3A%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_key%2C%20cboot_dict%20in%20wafer_data.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20VOUT%20value%20from%20directory%20name%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vout_value%20%3D%20float(vout_key.replace('VOUT'%2C%20''))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'vout_conditions'%5D.append(vout_value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%5B'vout_conditions'%5D.add(vout_value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'errors'%5D.append(f%22Could%20not%20parse%20VOUT%20from%20%7Bvout_key%7D%20in%20%7Bwafer_key%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_key%2C%20file_list%20in%20cboot_dict.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cboot_key%20!%3D%20%22direct%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20CBOOT%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_value%20%3D%20float(cboot_key)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'cboot_values'%5D.append(cboot_value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%5B'cboot_values'%5D.add(cboot_value)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'errors'%5D.append(f%22Could%20not%20parse%20CBOOT%20from%20%7Bcboot_key%7D%20in%20%7Bwafer_key%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20file_count%20%3D%20len(file_list)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'total_files'%5D%20%2B%3D%20file_count%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%5B'file_count'%5D%20%2B%3D%20file_count%0A%0A%20%20%20%20%20%20%20%20%23%20Remove%20duplicates%20and%20sort%0A%20%20%20%20%20%20%20%20validation_results%5B'vout_conditions'%5D%20%3D%20sorted(list(set(validation_results%5B'vout_conditions'%5D)))%0A%20%20%20%20%20%20%20%20validation_results%5B'cboot_values'%5D%20%3D%20sorted(list(set(validation_results%5B'cboot_values'%5D)))%0A%0A%20%20%20%20%20%20%20%20%23%20Convert%20sets%20to%20lists%20in%20wafer%20metadata%0A%20%20%20%20%20%20%20%20for%20wafer_key%20in%20validation_results%5B'wafer_metadata'%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%5B'vout_conditions'%5D%20%3D%20sorted(list(validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%5B'vout_conditions'%5D))%0A%20%20%20%20%20%20%20%20%20%20%20%20validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%5B'cboot_values'%5D%20%3D%20sorted(list(validation_results%5B'wafer_metadata'%5D%5Bwafer_key%5D%5B'cboot_values'%5D))%0A%0A%20%20%20%20%20%20%20%20return%20validation_results%0A%0A%20%20%20%20%23%20Discover%20files%20and%20validate%20structure%20with%20dynamic%20wafer%20detection%0A%20%20%20%20tm_scope_files_discovered_v10%20%3D%20discover_tm_scope_files_dynamic(resolved_start_path)%0A%20%20%20%20tm_file_validation_results_v10%20%3D%20validate_file_structure_with_wafers(tm_scope_files_discovered_v10)%0A%0A%20%20%20%20%23%20Construct%20base%20path%20for%20tm_scope%20data%20(now%20includes%20wafer%20directories)%0A%20%20%20%20tm_scope_base_path_v10%20%3D%20os.path.join(resolved_start_path%2C%20%0A%20%20%20%20%20%20%20%20%22USDCT1_PA%22%2C%20%22Parent_Dir%22%2C%20%22Data_to_organize%22%2C%20%0A%20%20%20%20%20%20%20%20%22Lab_Instrument_Doc%22%2C%20%22TC2_software%22%2C%20%22sps_gui%22%2C%20%0A%20%20%20%20%20%20%20%20%22src%22%2C%20%22sps_gui%22%2C%20%22utils%22%2C%20%22notebooks%22%2C%20%22tm_scope_data%22)%20if%20resolved_start_path%20else%20%22%22%0A%0A%20%20%20%20%23%20Display%20discovery%20results%20with%20wafer%20breakdown%0A%20%20%20%20if%20tm_scope_files_discovered_v10%3A%0A%20%20%20%20%20%20%20%20print(%22%F0%9F%93%81%20Discovered%20tm_scope%20Excel%20Files%20(v10%20-%20Dynamic%20Wafer%20Discovery)%3A%22)%0A%20%20%20%20%20%20%20%20for%20wafer_key%2C%20wafer_data%20in%20tm_scope_files_discovered_v10.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wafer_metadata%20%3D%20tm_file_validation_results_v10%5B'wafer_metadata'%5D.get(wafer_key%2C%20%7B%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%5Cn%20%20%F0%9F%A7%AC%20%7Bwafer_key%7D%20(%7Bwafer_metadata.get('file_count'%2C%200)%7D%20files)%3A%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20VOUT%20conditions%3A%20%7Bwafer_metadata.get('vout_conditions'%2C%20%5B%5D)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20CBOOT%20values%3A%20%7Bwafer_metadata.get('cboot_values'%2C%20%5B%5D)%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_key%2C%20cboot_dict%20in%20wafer_data.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%F0%9F%93%82%20%7Bvout_key%7D%3A%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_key%2C%20file_list%20in%20cboot_dict.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%20%20%F0%9F%93%81%20%7Bcboot_key%7D%3A%20%7Blen(file_list)%7D%20files%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20file_item%20in%20file_list%5B%3A2%5D%3A%20%20%23%20Show%20first%202%20files%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%20%20%20%20%E2%80%A2%20%7Bfile_item%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(file_list)%20%3E%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%20%20%20%20...%20and%20%7Blen(file_list)%20-%202%7D%20more%22)%0A%0A%20%20%20%20%20%20%20%20print(f%22%5Cn%20%20%F0%9F%93%8A%20Overall%20Validation%20Results%3A%22)%0A%20%20%20%20%20%20%20%20print(f%22%20%20%20%20Total%20wafer%20directories%3A%20%7Blen(tm_file_validation_results_v10%5B'wafer_directories'%5D)%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22%20%20%20%20Wafer%20types%3A%20%7Btm_file_validation_results_v10%5B'wafer_directories'%5D%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22%20%20%20%20Total%20files%3A%20%7Btm_file_validation_results_v10%5B'total_files'%5D%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22%20%20%20%20All%20VOUT%20conditions%3A%20%7Btm_file_validation_results_v10%5B'vout_conditions'%5D%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22%20%20%20%20All%20CBOOT%20values%3A%20%7Btm_file_validation_results_v10%5B'cboot_values'%5D%7D%22)%0A%0A%20%20%20%20%20%20%20%20if%20tm_file_validation_results_v10%5B'errors'%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20Errors%3A%20%7Btm_file_validation_results_v10%5B'errors'%5D%7D%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print(%22%E2%9D%8C%20No%20tm_scope%20Excel%20files%20found%22)%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20tm_file_validation_results_v10%2C%0A%20%20%20%20%20%20%20%20tm_scope_base_path_v10%2C%0A%20%20%20%20%20%20%20%20tm_scope_files_discovered_v10%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(%0A%20%20%20%20mo%2C%0A%20%20%20%20tm_file_validation_results_v10%2C%0A%20%20%20%20tm_scope_base_path_v10%2C%0A%20%20%20%20tm_scope_files_discovered_v10%2C%0A)%3A%0A%20%20%20%20%23%20Create%20UI%20for%20tm_scope%20file%20discovery%20with%20wafer%20selection%0A%20%20%20%20if%20tm_scope_files_discovered_v10%3A%0A%20%20%20%20%20%20%20%20%23%20Generate%20filter%20options%20from%20discovered%20data%20including%20wafer%20selection%0A%20%20%20%20%20%20%20%20wafer_options%20%3D%20tm_file_validation_results_v10%5B'wafer_directories'%5D%20%2B%20%5B%22All%22%5D%0A%20%20%20%20%20%20%20%20vout_options%20%3D%20%5Bf%22%7Bv%7DV%22%20for%20v%20in%20tm_file_validation_results_v10%5B'vout_conditions'%5D%5D%20%2B%20%5B%22All%22%5D%0A%20%20%20%20%20%20%20%20cboot_options%20%3D%20%5Bf%22%7Bc%7D%CE%BCF%22%20for%20c%20in%20tm_file_validation_results_v10%5B'cboot_values'%5D%5D%20%2B%20%5B%22All%22%5D%0A%0A%20%20%20%20%20%20%20%20%23%20Wafer%20selector%20(NEW%20in%20v10)%0A%20%20%20%20%20%20%20%20tm_wafer_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dwafer_options%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D%22All%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Select%20Wafer%20Type%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Voltage%20selector%0A%20%20%20%20%20%20%20%20tm_voltage_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dvout_options%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D%22All%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Select%20VOUT%20Filter%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Cboot%20selector%0A%20%20%20%20%20%20%20%20tm_cboot_selector%20%3D%20mo.ui.dropdown(%0A%20%20%20%20%20%20%20%20%20%20%20%20options%3Dcboot_options%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20value%3D%22All%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20label%3D%22Select%20CBOOT%20Filter%22%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Enhanced%20file%20status%20display%20with%20wafer%20information%0A%20%20%20%20%20%20%20%20wafer_summary_v10%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20wafer_name_v10%20in%20tm_file_validation_results_v10%5B'wafer_directories'%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wafer_meta_v10%20%3D%20tm_file_validation_results_v10%5B'wafer_metadata'%5D%5Bwafer_name_v10%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20wafer_summary_v10.append(f%22**%7Bwafer_name_v10%7D%3A**%20%7Bwafer_meta_v10%5B'file_count'%5D%7D%20files%22)%0A%0A%20%20%20%20%20%20%20%20tm_file_status_display%20%3D%20mo.md(f%22%22%22%0A%20%20%20%20%20%20%20%20%23%23%23%20%F0%9F%93%8A%20File%20Discovery%20Status%20(v10%3A%20Dynamic%20Wafer%20Discovery)%0A%0A%20%20%20%20%20%20%20%20**Total%20Wafer%20Directories%3A**%20%7Blen(tm_file_validation_results_v10%5B'wafer_directories'%5D)%7D%20%20%0A%20%20%20%20%20%20%20%20%7Bchr(10).join(wafer_summary_v10)%7D%0A%0A%20%20%20%20%20%20%20%20**Total%20Files%20Discovered%3A**%20%7Btm_file_validation_results_v10%5B'total_files'%5D%7D%20%20%0A%20%20%20%20%20%20%20%20**VOUT%20Conditions%3A**%20%7B'%2C%20'.join(%5Bf'%7Bv%7DV'%20for%20v%20in%20tm_file_validation_results_v10%5B'vout_conditions'%5D%5D)%7D%20%20%0A%20%20%20%20%20%20%20%20**CBOOT%20Values%3A**%20%7B'%2C%20'.join(%5Bf'%7Bc%7D%CE%BCF'%20for%20c%20in%20tm_file_validation_results_v10%5B'cboot_values'%5D%5D)%7D%20%20%0A%20%20%20%20%20%20%20%20**Base%20Path%3A**%20%60%7Btm_scope_base_path_v10%7D%60%0A%20%20%20%20%20%20%20%20%22%22%22)%0A%0A%20%20%20%20%20%20%20%20tm_scope_ui%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20tm_scope%20File%20Discovery%20(v10%3A%20Dynamic%20Wafer%20Discovery)%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tm_file_status_display%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tm_wafer_selector%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tm_voltage_selector%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tm_cboot_selector%2C%0A%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%23%20Create%20dummy%20components%20to%20maintain%20Marimo%20variable%20consistency%0A%20%20%20%20%20%20%20%20tm_wafer_selector%20%3D%20mo.ui.dropdown(options%3D%5B%22No%20data%22%5D%2C%20value%3D%22No%20data%22%2C%20label%3D%22No%20wafer%20data%20available%22)%0A%20%20%20%20%20%20%20%20tm_voltage_selector%20%3D%20mo.ui.dropdown(options%3D%5B%22No%20data%22%5D%2C%20value%3D%22No%20data%22%2C%20label%3D%22No%20VOUT%20data%20available%22)%0A%20%20%20%20%20%20%20%20tm_cboot_selector%20%3D%20mo.ui.dropdown(options%3D%5B%22No%20data%22%5D%2C%20value%3D%22No%20data%22%2C%20label%3D%22No%20CBOOT%20data%20available%22)%0A%20%20%20%20%20%20%20%20tm_file_status_display%20%3D%20mo.md(%22%E2%9D%8C%20No%20tm_scope%20files%20discovered%22)%0A%20%20%20%20%20%20%20%20tm_scope_ui%20%3D%20mo.md(%22%E2%9D%8C%20No%20tm_scope%20files%20available%20for%20processing%22)%0A%0A%20%20%20%20return%20(tm_scope_ui%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(tm_scope_ui)%3A%0A%20%20%20%20tm_scope_ui%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D5%2C%20hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Column_F%3A%20Data%20Extraction%20%26%20Enhanced%20TMScopeDataCollection%20(v10%3A%20Wafer%20Hierarchy)%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Data%20Extraction%20and%20Enhanced%20Collection%20Creation%20(v10)%0A%0A%20%20%20%20Parse%20Excel%20files%20and%20build%20enhanced%20hierarchical%20TMScopeDataCollection%20structure%20with%20wafer%20dimension.%0A%0A%20%20%20%20**Enhanced%20Data%20Organization%20(v10)%3A**%0A%20%20%20%20-%20WAFER%20%3E%20VOUT%20%3E%20CBOOT%20%3E%20SW%2FPH%20%3E%20LOAD%20hierarchy%20(NEW)%0A%20%20%20%20-%20Shared%20time%20base%20from%20CH1-SW_wfm%20%22Time%20(s)%22%20column%20%20%0A%20%20%20%20-%20Load%20mapping%20from%20acquisition%20columns%0A%20%20%20%20-%20Wafer%20metadata%20tracking%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(Any%2C%20Dict%2C%20List%2C%20Optional%2C%20dataclass%2C%20pd)%3A%0A%20%20%20%20%23%20Column%20F%3A%20Enhanced%20TMScopeDataCollection%20with%20Wafer%20Hierarchy%20(v10)%0A%20%20%20%20%40dataclass%0A%20%20%20%20class%20TMScopeDataCollection%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Enhanced%20hierarchical%20data%20container%3A%20WAFER%20%3E%20VOUT%20%3E%20CBOOT%20%3E%20SW%2FPH%20%3E%20LOAD%20(v10)%0A%0A%20%20%20%20%20%20%20%20Structure%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20data%5Bwafer%5D%5Bvout%5D%5Bcboot%5D%5Bchannel%5D%5Bload%5D%20%3D%20pd.Series%20(y-values)%0A%20%20%20%20%20%20%20%20%20%20%20%20time_base%5Bwafer%5D%5Bvout%5D%5Bcboot%5D%20%3D%20pd.Series%20(shared%20x-values%20from%20%22Time%20(s)%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20metadata%5Bwafer%5D%20%3D%20Dict%5Bstr%2C%20Any%5D%20(wafer-specific%20metadata)%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20data%3A%20Dict%5Bstr%2C%20Dict%5Bfloat%2C%20Dict%5Bfloat%2C%20Dict%5Bstr%2C%20Dict%5Bstr%2C%20pd.Series%5D%5D%5D%5D%5D%0A%20%20%20%20%20%20%20%20time_base%3A%20Dict%5Bstr%2C%20Dict%5Bfloat%2C%20Dict%5Bfloat%2C%20pd.Series%5D%5D%5D%0A%20%20%20%20%20%20%20%20metadata%3A%20Dict%5Bstr%2C%20Dict%5Bstr%2C%20Any%5D%5D%0A%0A%20%20%20%20%20%20%20%20def%20get_available_wafer_names(self)%20-%3E%20List%5Bstr%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Return%20all%20available%20wafer%20directory%20names%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(self.data.keys())%0A%0A%20%20%20%20%20%20%20%20def%20get_available_vout_values(self%2C%20wafer%3A%20Optional%5Bstr%5D%20%3D%20None)%20-%3E%20List%5Bfloat%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Return%20all%20available%20VOUT%20values%2C%20optionally%20filtered%20by%20wafer%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20wafer%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(self.data.get(wafer%2C%20%7B%7D).keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_vout%20%3D%20set()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20wafer_data%20in%20self.data.values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_vout.update(wafer_data.keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(all_vout)%0A%0A%20%20%20%20%20%20%20%20def%20get_available_cboot_values(self%2C%20wafer%3A%20Optional%5Bstr%5D%20%3D%20None%2C%20vout%3A%20Optional%5Bfloat%5D%20%3D%20None)%20-%3E%20List%5Bfloat%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Return%20all%20available%20CBOOT%20values%2C%20optionally%20filtered%20by%20wafer%20and%2For%20VOUT%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20wafer%20is%20not%20None%20and%20vout%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(self.data.get(wafer%2C%20%7B%7D).get(vout%2C%20%7B%7D).keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20elif%20wafer%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_cboot%20%3D%20set()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_data%20in%20self.data.get(wafer%2C%20%7B%7D).values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_cboot.update(vout_data.keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(all_cboot)%0A%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_cboot%20%3D%20set()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20wafer_data%20in%20self.data.values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_data%20in%20wafer_data.values()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_cboot.update(vout_data.keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(all_cboot)%0A%0A%20%20%20%20%20%20%20%20def%20get_available_channels(self%2C%20wafer%3A%20Optional%5Bstr%5D%20%3D%20None%2C%20vout%3A%20Optional%5Bfloat%5D%20%3D%20None%2C%20cboot%3A%20Optional%5Bfloat%5D%20%3D%20None)%20-%3E%20List%5Bstr%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Return%20all%20available%20channels%20(SW%2C%20PH)%2C%20optionally%20filtered%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20channels%20%3D%20set()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20wafers_to_check%20%3D%20%5Bwafer%5D%20if%20wafer%20is%20not%20None%20else%20self.data.keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20w%20in%20wafers_to_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vouts_to_check%20%3D%20%5Bvout%5D%20if%20vout%20is%20not%20None%20else%20self.data.get(w%2C%20%7B%7D).keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20v%20in%20vouts_to_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboots_to_check%20%3D%20%5Bcboot%5D%20if%20cboot%20is%20not%20None%20else%20self.data.get(w%2C%20%7B%7D).get(v%2C%20%7B%7D).keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20cboots_to_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20channels.update(self.data.get(w%2C%20%7B%7D).get(v%2C%20%7B%7D).get(c%2C%20%7B%7D).keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(channels)%0A%0A%20%20%20%20%20%20%20%20def%20get_available_loads(self%2C%20wafer%3A%20Optional%5Bstr%5D%20%3D%20None%2C%20vout%3A%20Optional%5Bfloat%5D%20%3D%20None%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot%3A%20Optional%5Bfloat%5D%20%3D%20None%2C%20channel%3A%20Optional%5Bstr%5D%20%3D%20None)%20-%3E%20List%5Bstr%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22Return%20all%20available%20load%20conditions%2C%20optionally%20filtered%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20loads%20%3D%20set()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20wafers_to_check%20%3D%20%5Bwafer%5D%20if%20wafer%20is%20not%20None%20else%20self.data.keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20w%20in%20wafers_to_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vouts_to_check%20%3D%20%5Bvout%5D%20if%20vout%20is%20not%20None%20else%20self.data.get(w%2C%20%7B%7D).keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20v%20in%20vouts_to_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboots_to_check%20%3D%20%5Bcboot%5D%20if%20cboot%20is%20not%20None%20else%20self.data.get(w%2C%20%7B%7D).get(v%2C%20%7B%7D).keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20cboots_to_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20channels_to_check%20%3D%20%5Bchannel%5D%20if%20channel%20is%20not%20None%20else%20self.data.get(w%2C%20%7B%7D).get(v%2C%20%7B%7D).get(c%2C%20%7B%7D).keys()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20ch%20in%20channels_to_check%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20loads.update(self.data.get(w%2C%20%7B%7D).get(v%2C%20%7B%7D).get(c%2C%20%7B%7D).get(ch%2C%20%7B%7D).keys())%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20sorted(loads)%0A%0A%20%20%20%20return%20(TMScopeDataCollection%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(Any%2C%20Dict%2C%20TMScopeDataCollection%2C%20os%2C%20pd)%3A%0A%20%20%20%20%23%20Enhanced%20Excel%20parsing%20functions%20for%20TMScopeDataCollection%20with%20wafer%20hierarchy%20(v10)%0A%20%20%20%20def%20parse_excel_to_hierarchical_structure_v10(file_path%3A%20str)%20-%3E%20Dict%5Bstr%2C%20Any%5D%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Extract%20waveform%20data%20from%20single%20Excel%20file%20with%20wafer%20detection%20(v10%20Enhancement)%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20WAFER%2C%20VOUT%20and%20CBOOT%20from%20file%20path%20-%20enhanced%20parsing%20for%20wafer%20detection%0A%20%20%20%20%20%20%20%20%20%20%20%20path_parts%20%3D%20file_path.split(os.sep)%0A%20%20%20%20%20%20%20%20%20%20%20%20wafer_dir%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20vout_dir%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20cboot_dir%20%3D%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Find%20wafer%20directory%20(contains%20'Wave'%20or%20similar%20pattern)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20part%20in%20path_parts%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20('Wave'%20in%20part%20or%20'wafer'%20in%20part.lower())%20and%20part%20!%3D%20file_path.split(os.sep)%5B-1%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wafer_dir%20%3D%20part%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Find%20VOUT%20directory%20(contains%20'VOUT'%20in%20name)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20part%20in%20path_parts%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20'VOUT'%20in%20part%20and%20part%20!%3D%20file_path.split(os.sep)%5B-1%5D%3A%20%20%23%20Not%20the%20filename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vout_dir%20%3D%20part%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Find%20CBOOT%20directory%20(should%20be%20numeric%20like%200.1%2C%200.22%2C%200.47)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20part%20in%20path_parts%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20part%20!%3D%20file_path.split(os.sep)%5B-1%5D%3A%20%20%23%20Not%20the%20filename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Check%20if%20it's%20a%20valid%20cboot%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_test%20%3D%20float(part)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%200.01%20%3C%3D%20cboot_test%20%3C%3D%201.0%3A%20%20%23%20Reasonable%20range%20for%20cboot%20in%20%CE%BCF%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_dir%20%3D%20part%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Skip%20files%20in%20.ALL%20directories%20or%20if%20we%20can't%20extract%20all%20values%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20wafer_dir%20or%20not%20vout_dir%20or%20not%20cboot_dir%20or%20'.ALL'%20in%20file_path%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Parse%20WAFER%2C%20VOUT%20and%20CBOOT%20values%20with%20robust%20error%20handling%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vout_value%20%3D%20float(vout_dir.replace('VOUT'%2C%20''))%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(f%22Could%20not%20parse%20VOUT%20value%20from%3A%20%7Bvout_dir%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_value%20%3D%20float(cboot_dir)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(f%22Could%20not%20parse%20CBOOT%20value%20from%3A%20%7Bcboot_dir%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Load%20Excel%20file%20with%20error%20handling%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xl_file%20%3D%20pd.ExcelFile(file_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20raise%20ValueError(f%22Could%20not%20open%20Excel%20file%3A%20%7Be%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20time%20base%20from%20CH1-SW_wfm%20sheet%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20'CH1-SW_wfm'%20not%20in%20xl_file.sheet_names%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20Missing%20CH1-SW_wfm%20sheet%20in%20%7Bos.path.basename(file_path)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ch1_df%20%3D%20pd.read_excel(file_path%2C%20sheet_name%3D'CH1-SW_wfm')%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20Error%20reading%20CH1-SW_wfm%20sheet%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Get%20time%20data%20from%20column%20A%20%22Time%20(s)%22%20with%20fallback%20options%0A%20%20%20%20%20%20%20%20%20%20%20%20time_column%20%3D%20None%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20col%20in%20%5B'Time%20(s)'%2C%20'Time(s)'%2C%20'Time'%2C%20'time'%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20col%20in%20ch1_df.columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20time_column%20%3D%20col%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20time_column%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20No%20time%20column%20found%20in%20%7Bos.path.basename(file_path)%7D.%20Available%20columns%3A%20%7Blist(ch1_df.columns)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20time_data%20%3D%20ch1_df%5Btime_column%5D.dropna()%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20len(time_data)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20Empty%20time%20data%20in%20%7Bos.path.basename(file_path)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20CH1%20(SW)%20waveform%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20ch1_data%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20acq_columns%20%3D%20%5Bcol%20for%20col%20in%20ch1_df.columns%20if%20col.startswith('Acq_')%20and%20'CH1'%20in%20col%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20col%20in%20acq_columns%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20acquisition%20number%20more%20robustly%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parts%20%3D%20col.split('_')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(parts)%20%3E%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20acq_num%20%3D%20int(parts%5B1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_current%20%3D%20map_acquisition_to_load(acq_num)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_name%20%3D%20f%22Load_%7Bload_current%7DA%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Only%20store%20non-empty%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20col_data%20%3D%20ch1_df%5Bcol%5D.dropna()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(col_data)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ch1_data%5Bload_name%5D%20%3D%20col_data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20(ValueError%2C%20IndexError)%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20Could%20not%20parse%20acquisition%20column%20%7Bcol%7D%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20CH3%20(PH)%20waveform%20data%20if%20available%0A%20%20%20%20%20%20%20%20%20%20%20%20ch3_data%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20'CH3-PH_wfm'%20in%20xl_file.sheet_names%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ch3_df%20%3D%20pd.read_excel(file_path%2C%20sheet_name%3D'CH3-PH_wfm')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20acq_columns_ch3%20%3D%20%5Bcol%20for%20col%20in%20ch3_df.columns%20if%20col.startswith('Acq_')%20and%20'CH3'%20in%20col%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20col%20in%20acq_columns_ch3%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parts%20%3D%20col.split('_')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(parts)%20%3E%3D%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20acq_num%20%3D%20int(parts%5B1%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_current%20%3D%20map_acquisition_to_load(acq_num)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_name%20%3D%20f%22Load_%7Bload_current%7DA%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Only%20store%20non-empty%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20col_data%20%3D%20ch3_df%5Bcol%5D.dropna()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20len(col_data)%20%3E%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ch3_data%5Bload_name%5D%20%3D%20col_data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20(ValueError%2C%20IndexError)%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20Could%20not%20parse%20CH3%20acquisition%20column%20%7Bcol%7D%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20Error%20reading%20CH3-PH_wfm%20sheet%3A%20%7Be%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Ensure%20we%20have%20some%20data%20to%20work%20with%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20ch1_data%20and%20not%20ch3_data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9A%A0%EF%B8%8F%20No%20valid%20acquisition%20data%20found%20in%20%7Bos.path.basename(file_path)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wafer%22%3A%20wafer_dir%2C%20%20%23%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22vout%22%3A%20vout_value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22cboot%22%3A%20cboot_value%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22time_data%22%3A%20time_data%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22ch1_data%22%3A%20ch1_data%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22ch3_data%22%3A%20ch3_data%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22load_mapping%22%3A%20get_load_mapping()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22metadata%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22filename%22%3A%20os.path.basename(file_path)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22file_path%22%3A%20file_path%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wafer_directory%22%3A%20wafer_dir%2C%20%20%23%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22sheets_found%22%3A%20xl_file.sheet_names%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20except%20Exception%20as%20e%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9D%8C%20Error%20parsing%20%7Bfile_path%7D%3A%20%7Be%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%0A%0A%20%20%20%20def%20map_acquisition_to_load(acq_num%3A%20int)%20-%3E%20int%3A%0A%20%20%20%20%20%20%20%20%22%22%22Map%20acquisition%20number%20to%20load%20current%20value%22%22%22%0A%20%20%20%20%20%20%20%20%23%20Based%20on%20provided%20mapping%20from%20plan%0A%20%20%20%20%20%20%20%20load_mapping%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%201%3A%200%2C%202%3A%200%2C%203%3A%201%2C%204%3A%202%2C%205%3A%203%2C%206%3A%204%2C%207%3A%205%2C%208%3A%206%2C%209%3A%207%2C%2010%3A%208%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2011%3A%209%2C%2012%3A%2010%2C%2013%3A%2015%2C%2014%3A%2016%2C%2015%3A%2017%2C%2016%3A%2018%2C%2017%3A%2019%2C%2018%3A%2020%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2019%3A%2025%2C%2020%3A%2028%2C%2021%3A%2029%2C%2022%3A%2030%2C%2023%3A%2031%2C%2024%3A%2035%2C%2025%3A%2040%2C%2026%3A%2045%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2027%3A%2050%2C%2028%3A%2055%2C%2029%3A%2060%2C%2030%3A%2065%2C%2031%3A%2070%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20load_mapping.get(acq_num%2C%20acq_num)%20%20%23%20Default%20to%20acq_num%20if%20not%20in%20mapping%0A%0A%20%20%20%20def%20get_load_mapping()%20-%3E%20Dict%5Bint%2C%20int%5D%3A%0A%20%20%20%20%20%20%20%20%22%22%22Return%20the%20acquisition%20to%20load%20mapping%20dictionary%22%22%22%0A%20%20%20%20%20%20%20%20return%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%201%3A%200%2C%202%3A%200%2C%203%3A%201%2C%204%3A%202%2C%205%3A%203%2C%206%3A%204%2C%207%3A%205%2C%208%3A%206%2C%209%3A%207%2C%2010%3A%208%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2011%3A%209%2C%2012%3A%2010%2C%2013%3A%2015%2C%2014%3A%2016%2C%2015%3A%2017%2C%2016%3A%2018%2C%2017%3A%2019%2C%2018%3A%2020%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2019%3A%2025%2C%2020%3A%2028%2C%2021%3A%2029%2C%2022%3A%2030%2C%2023%3A%2031%2C%2024%3A%2035%2C%2025%3A%2040%2C%2026%3A%2045%2C%0A%20%20%20%20%20%20%20%20%20%20%20%2027%3A%2050%2C%2028%3A%2055%2C%2029%3A%2060%2C%2030%3A%2065%2C%2031%3A%2070%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20def%20build_tmscope_collection_v10(discovered_files%3A%20Dict%2C%20base_path%3A%20str)%20-%3E%20TMScopeDataCollection%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Enhanced%20collection%20builder%20from%20discovered%20files%20with%20wafer%20hierarchy%20(v10)%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20collection_data%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20collection_time_base%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20collection_metadata%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20extraction_metadata%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22files_processed%22%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22files_failed%22%3A%200%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22wafers_found%22%3A%20set()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22conditions_found%22%3A%20set()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22processing_errors%22%3A%20%5B%5D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20for%20wafer_dir%2C%20wafer_data%20in%20discovered_files.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20extraction_metadata%5B%22wafers_found%22%5D.add(wafer_dir)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_dir%2C%20cboot_dict%20in%20wafer_data.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_dir%2C%20file_list%20in%20cboot_dict.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cboot_dir%20%3D%3D%20%22direct%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%20%20%23%20Skip%20direct%20files%20for%20now%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Process%20first%20file%20from%20each%20condition%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20file_list%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20file_path%20%3D%20os.path.join(base_path%2C%20wafer_dir%2C%20vout_dir%2C%20cboot_dir%2C%20file_list%5B0%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Only%20process%20files%20that%20are%20not%20in%20skip%20directories%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20'.ALL'%20in%20file_path%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%8F%AD%EF%B8%8F%20Skipping%20.ALL%20directory%20file%3A%20%7Bos.path.basename(file_path)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20parsed_data%20%3D%20parse_excel_to_hierarchical_structure_v10(file_path)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20parsed_data%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wafer_from_parsed%20%3D%20parsed_data%5B%22wafer%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vout_from_parsed%20%3D%20parsed_data%5B%22vout%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_from_parsed%20%3D%20parsed_data%5B%22cboot%22%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Initialize%20hierarchical%20structure%20with%20wafer%20dimension%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20wafer_from_parsed%20not%20in%20collection_data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_data%5Bwafer_from_parsed%5D%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_time_base%5Bwafer_from_parsed%5D%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_metadata%5Bwafer_from_parsed%5D%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wafer_directory%22%3A%20wafer_from_parsed%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22conditions%22%3A%20set()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22files_processed%22%3A%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20vout_from_parsed%20not%20in%20collection_data%5Bwafer_from_parsed%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_data%5Bwafer_from_parsed%5D%5Bvout_from_parsed%5D%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_time_base%5Bwafer_from_parsed%5D%5Bvout_from_parsed%5D%20%3D%20%7B%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20cboot_from_parsed%20not%20in%20collection_data%5Bwafer_from_parsed%5D%5Bvout_from_parsed%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_data%5Bwafer_from_parsed%5D%5Bvout_from_parsed%5D%5Bcboot_from_parsed%5D%20%3D%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_time_base%5Bwafer_from_parsed%5D%5Bvout_from_parsed%5D%5Bcboot_from_parsed%5D%20%3D%20parsed_data%5B%22time_data%22%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Store%20channel%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20parsed_data%5B%22ch1_data%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_data%5Bwafer_from_parsed%5D%5Bvout_from_parsed%5D%5Bcboot_from_parsed%5D%5B%22SW%22%5D%20%3D%20parsed_data%5B%22ch1_data%22%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20parsed_data%5B%22ch3_data%22%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_data%5Bwafer_from_parsed%5D%5Bvout_from_parsed%5D%5Bcboot_from_parsed%5D%5B%22PH%22%5D%20%3D%20parsed_data%5B%22ch3_data%22%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Update%20metadata%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20extraction_metadata%5B%22files_processed%22%5D%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_metadata%5Bwafer_from_parsed%5D%5B%22files_processed%22%5D%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20condition_id%20%3D%20f%22%7Bwafer_from_parsed%7D_VOUT_%7Bvout_from_parsed%7DV_CBOOT_%7Bcboot_from_parsed%7D%CE%BCF%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20extraction_metadata%5B%22conditions_found%22%5D.add(condition_id)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_metadata%5Bwafer_from_parsed%5D%5B%22conditions%22%5D.add(condition_id)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9C%85%20Processed%3A%20%7Bcondition_id%7D%20from%20%7Bos.path.basename(file_path)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20extraction_metadata%5B%22files_failed%22%5D%20%2B%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%8F%AD%EF%B8%8F%20Skipped%3A%20%7Bos.path.basename(file_path)%7D%20(unsupported%20format%20or%20.ALL%20directory)%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Convert%20sets%20to%20lists%20for%20JSON%20serialization%0A%20%20%20%20%20%20%20%20extraction_metadata%5B%22wafers_found%22%5D%20%3D%20list(extraction_metadata%5B%22wafers_found%22%5D)%0A%20%20%20%20%20%20%20%20extraction_metadata%5B%22conditions_found%22%5D%20%3D%20list(extraction_metadata%5B%22conditions_found%22%5D)%0A%0A%20%20%20%20%20%20%20%20for%20wafer_in_metadata%20in%20collection_metadata%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20wafer_in_metadata%20!%3D%20%22_extraction_summary%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection_metadata%5Bwafer_in_metadata%5D%5B%22conditions%22%5D%20%3D%20list(collection_metadata%5Bwafer_in_metadata%5D%5B%22conditions%22%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20extraction%20metadata%20to%20collection%20metadata%0A%20%20%20%20%20%20%20%20collection_metadata%5B%22_extraction_summary%22%5D%20%3D%20extraction_metadata%0A%0A%20%20%20%20%20%20%20%20return%20TMScopeDataCollection(%0A%20%20%20%20%20%20%20%20%20%20%20%20data%3Dcollection_data%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20time_base%3Dcollection_time_base%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20metadata%3Dcollection_metadata%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20return%20(build_tmscope_collection_v10%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(%0A%20%20%20%20TMScopeDataCollection%2C%0A%20%20%20%20build_tmscope_collection_v10%2C%0A%20%20%20%20tm_scope_base_path_v10%2C%0A%20%20%20%20tm_scope_files_discovered_v10%2C%0A)%3A%0A%20%20%20%20%23%20Build%20enhanced%20TMScopeDataCollection%20from%20discovered%20files%20with%20wafer%20hierarchy%20(v10)%0A%20%20%20%20if%20tm_scope_files_discovered_v10%20and%20tm_scope_base_path_v10%3A%0A%20%20%20%20%20%20%20%20print(%22%F0%9F%94%84%20Building%20Enhanced%20TMScopeDataCollection%20with%20wafer%20hierarchy%20(v10)...%22)%0A%0A%20%20%20%20%20%20%20%20tm_scope_collection_v10%20%3D%20build_tmscope_collection_v10(%0A%20%20%20%20%20%20%20%20%20%20%20%20tm_scope_files_discovered_v10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tm_scope_base_path_v10%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Display%20extraction%20results%20with%20wafer%20breakdown%0A%20%20%20%20%20%20%20%20if%20tm_scope_collection_v10.data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20extraction_metadata%20%3D%20tm_scope_collection_v10.metadata.get(%22_extraction_summary%22%2C%20%7B%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%E2%9C%85%20Enhanced%20TMScopeDataCollection%20(v10)%20built%20successfully!%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Files%20processed%3A%20%7Bextraction_metadata.get('files_processed'%2C%200)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Files%20failed%3A%20%7Bextraction_metadata.get('files_failed'%2C%200)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Wafers%20found%3A%20%7Blen(extraction_metadata.get('wafers_found'%2C%20%5B%5D))%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Wafer%20types%3A%20%7Bextraction_metadata.get('wafers_found'%2C%20%5B%5D)%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Total%20conditions%3A%20%7Blen(extraction_metadata.get('conditions_found'%2C%20%5B%5D))%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Show%20available%20data%20structure%20with%20wafer%20dimension%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%5Cn%F0%9F%93%8A%20Available%20Data%20(v10%20-%20Wafer%20Hierarchy)%3A%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20wafer_name_in_collection%20in%20tm_scope_collection_v10.get_available_wafer_names()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wafer_meta_in_collection%20%3D%20tm_scope_collection_v10.metadata.get(wafer_name_in_collection%2C%20%7B%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%F0%9F%A7%AC%20%7Bwafer_name_in_collection%7D%20(%7Bwafer_meta_in_collection.get('files_processed'%2C%200)%7D%20files)%3A%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_in_collection%20in%20tm_scope_collection_v10.get_available_vout_values(wafer_name_in_collection)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%20VOUT%20%7Bvout_in_collection%7DV%3A%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_in_collection%20in%20tm_scope_collection_v10.get_available_cboot_values(wafer_name_in_collection%2C%20vout_in_collection)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20channels_in_collection%20%3D%20tm_scope_collection_v10.get_available_channels(wafer_name_in_collection%2C%20vout_in_collection%2C%20cboot_in_collection)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20loads_in_collection%20%3D%20tm_scope_collection_v10.get_available_loads(wafer_name_in_collection%2C%20vout_in_collection%2C%20cboot_in_collection)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20%20%20%20%20CBOOT%20%7Bcboot_in_collection%7D%CE%BCF%3A%20%7Blen(channels_in_collection)%7D%20channels%2C%20%7Blen(loads_in_collection)%7D%20loads%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20data_quality_report_v10%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22total_wafers%22%3A%20len(extraction_metadata.get(%22wafers_found%22%2C%20%5B%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22wafer_names%22%3A%20extraction_metadata.get(%22wafers_found%22%2C%20%5B%5D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22total_conditions%22%3A%20len(extraction_metadata.get(%22conditions_found%22%2C%20%5B%5D))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22vout_values%22%3A%20tm_scope_collection_v10.get_available_vout_values()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22cboot_values%22%3A%20tm_scope_collection_v10.get_available_cboot_values()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22extraction_success_rate%22%3A%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20extraction_metadata.get(%22files_processed%22%2C%200)%20%2F%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(extraction_metadata.get(%22files_processed%22%2C%200)%20%2B%20extraction_metadata.get(%22files_failed%22%2C%200))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20extraction_metadata.get(%22files_processed%22%2C%200)%20%2B%20extraction_metadata.get(%22files_failed%22%2C%200)%20%3E%200%20else%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%22%E2%9D%8C%20Failed%20to%20build%20Enhanced%20TMScopeDataCollection%20-%20no%20data%20extracted%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20tm_scope_collection_v10%20%3D%20TMScopeDataCollection(data%3D%7B%7D%2C%20time_base%3D%7B%7D%2C%20metadata%3D%7B%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20data_quality_report_v10%20%3D%20%7B%22error%22%3A%20%22No%20data%20extracted%22%7D%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print(%22%E2%9A%A0%EF%B8%8F%20No%20files%20discovered%20or%20base%20path%20not%20available%22)%0A%20%20%20%20%20%20%20%20tm_scope_collection_v10%20%3D%20TMScopeDataCollection(data%3D%7B%7D%2C%20time_base%3D%7B%7D%2C%20metadata%3D%7B%7D)%0A%20%20%20%20%20%20%20%20data_quality_report_v10%20%3D%20%7B%22error%22%3A%20%22No%20files%20discovered%22%7D%0A%0A%20%20%20%20return%20data_quality_report_v10%2C%20tm_scope_collection_v10%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(data_quality_report_v10%2C%20mo%2C%20tm_scope_collection_v10)%3A%0A%20%20%20%20%23%20Display%20enhanced%20collection%20summary%20with%20wafer%20information%0A%20%20%20%20if%20tm_scope_collection_v10.data%3A%0A%20%20%20%20%20%20%20%20collection_summary_v10%20%3D%20mo.md(f%22%22%22%0A%20%20%20%20%20%20%20%20%23%23%23%20%F0%9F%93%8A%20Enhanced%20TMScopeDataCollection%20Summary%20(v10%3A%20Wafer%20Hierarchy)%0A%0A%20%20%20%20%20%20%20%20**Total%20Wafers%3A**%20%7Bdata_quality_report_v10.get('total_wafers'%2C%200)%7D%20%20%0A%20%20%20%20%20%20%20%20**Wafer%20Types%3A**%20%7B'%2C%20'.join(data_quality_report_v10.get('wafer_names'%2C%20%5B%5D))%7D%20%20%0A%20%20%20%20%20%20%20%20**Total%20Conditions%3A**%20%7Bdata_quality_report_v10.get('total_conditions'%2C%200)%7D%20%20%0A%20%20%20%20%20%20%20%20**VOUT%20Values%3A**%20%7B'%2C%20'.join(%5Bf'%7Bv%7DV'%20for%20v%20in%20data_quality_report_v10.get('vout_values'%2C%20%5B%5D)%5D)%7D%20%20%0A%20%20%20%20%20%20%20%20**CBOOT%20Values%3A**%20%7B'%2C%20'.join(%5Bf'%7Bc%7D%CE%BCF'%20for%20c%20in%20data_quality_report_v10.get('cboot_values'%2C%20%5B%5D)%5D)%7D%20%20%0A%20%20%20%20%20%20%20%20**Extraction%20Success%20Rate%3A**%20%7Bdata_quality_report_v10.get('extraction_success_rate'%2C%200)%3A.1%25%7D%0A%0A%20%20%20%20%20%20%20%20**Enhanced%20Data%20Structure%20(v10)%3A**%20WAFER%20%3E%20VOUT%20%3E%20CBOOT%20%3E%20Channel%20(SW%2FPH)%20%3E%20Load%20%20%0A%20%20%20%20%20%20%20%20**Time%20Base%3A**%20Shared%20from%20CH1-SW_wfm%20%22Time%20(s)%22%20column%20per%20wafer%2FVOUT%2FCBOOT%0A%20%20%20%20%20%20%20%20%22%22%22)%0A%0A%20%20%20%20%20%20%20%20data_validation_status_v10%20%3D%20mo.md(%22%E2%9C%85%20Enhanced%20data%20extraction%20(v10)%20completed%20successfully%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20collection_summary_v10%20%3D%20mo.md(%22%E2%9D%8C%20No%20data%20available%20in%20Enhanced%20TMScopeDataCollection%22)%0A%20%20%20%20%20%20%20%20data_validation_status_v10%20%3D%20mo.md(f%22%E2%9D%8C%20Enhanced%20data%20extraction%20failed%3A%20%7Bdata_quality_report_v10.get('error'%2C%20'Unknown%20error')%7D%22)%0A%0A%20%20%20%20return%20collection_summary_v10%2C%20data_validation_status_v10%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(collection_summary_v10%2C%20data_validation_status_v10%2C%20mo)%3A%0A%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20Enhanced%20Data%20Extraction%20Results%20(v10)%22)%2C%0A%20%20%20%20%20%20%20%20collection_summary_v10%2C%0A%20%20%20%20%20%20%20%20data_validation_status_v10%0A%20%20%20%20%5D)%0A%20%20%20%20return%0A%0A%0A%40app.cell(column%3D6%2C%20hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Column_G%3A%20Enhanced%20Plotly%20Visualization%20with%20Wafer%20Selection%20%2B%20Push-Button%20Filtering%20(v10)%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%23%20Enhanced%20Interactive%20Plotly%20Visualization%20with%20Wafer%20Selection%20%2B%20Push-Button%20Filtering%20(v10)%0A%0A%20%20%20%20Create%20comprehensive%20waveform%20plot%20with%20enhanced%20wafer%20support%3A%0A%20%20%20%20-%20**v10%20Enhancement**%3A%20Dynamic%20wafer%20directory%20discovery%20and%20selection%0A%20%20%20%20-%20**Wafer%20Checkbox%20Control**%3A%20Select%20specific%20wafer%20types%20(Wave1Wafer3_A0-V1%2C%20Wave2WaferX_A1-V1%2C%20etc.)%0A%20%20%20%20-%20**Plotly-resampler**%3A%20Automatic%20aggregation%20for%20large%20datasets%20(7.5M%2B%20points)%0A%20%20%20%20-%20**Individual%20trace%20control**%3A%20Each%20load%20condition%20independently%20selectable%0A%20%20%20%20-%20**Bulk%20selection%20controls**%3A%20WAFER%2C%20VOUT%2C%20CBOOT%2C%20Channel%20level%20filtering%0A%20%20%20%20-%20**Push-button%20filtering**%3A%20Dynamic%20buttons%20for%20WAFER%2C%20CH%2C%20VOUT%2C%20CBOOT%2C%20LOAD%20parameters%0A%20%20%20%20-%20**Intensity-based%20coloring**%3A%20Workbook%20base%20color%20%2B%20load%20intensity%0A%20%20%20%20-%20**Zoom-to-detail**%3A%20Full%20resolution%20data%20when%20zoomed%20in%0A%20%20%20%20-%20**Smart%20defaults**%3A%20Representative%20traces%20shown%20for%20large%20datasets%0A%0A%20%20%20%20**v10%20Data%20Hierarchy**%3A%20WAFER%20%3E%20VOUT%20%3E%20CBOOT%20%3E%20SW%2FPH%20%3E%20LOAD%0A%20%20%20%20**Enhanced%20Trace%20Naming**%3A%20Includes%20wafer%20identifier%20for%20disambiguation%0A%20%20%20%20**Memory%20Optimization**%3A%20449MB%20%E2%86%92%20%3C10MB%20output%20via%20automatic%20data%20aggregation%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(TMScopeDataCollection)%3A%0A%20%20%20%20%23%20Enhanced%20parameter%20extraction%20from%20tm_scope_collection%20with%20wafer%20support%20(v10)%0A%20%20%20%20def%20extract_parameter_values_v10(collection%3A%20TMScopeDataCollection)%20-%3E%20tuple%3A%0A%20%20%20%20%20%20%20%20%22%22%22Extract%20all%20unique%20parameter%20values%20including%20wafer%20names%20from%20the%20collection%20for%20button%20creation%20(v10)%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20collection.data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%2C%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20wafer_names%20%3D%20set()%0A%20%20%20%20%20%20%20%20channels%20%3D%20set()%0A%20%20%20%20%20%20%20%20vout_values%20%3D%20set()%0A%20%20%20%20%20%20%20%20cboot_values%20%3D%20set()%0A%20%20%20%20%20%20%20%20load_values%20%3D%20set()%0A%0A%20%20%20%20%20%20%20%20for%20wafer_for_params%20in%20collection.get_available_wafer_names()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20wafer_names.add(wafer_for_params)%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_for_params%20in%20collection.get_available_vout_values(wafer_for_params)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20vout_values.add(vout_for_params)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_for_params%20in%20collection.get_available_cboot_values(wafer_for_params%2C%20vout_for_params)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cboot_values.add(cboot_for_params)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20channel_for_params%20in%20collection.get_available_channels(wafer_for_params%2C%20vout_for_params%2C%20cboot_for_params)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20channels.add(channel_for_params)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20load_for_params%20in%20collection.get_available_loads(wafer_for_params%2C%20vout_for_params%2C%20cboot_for_params%2C%20channel_for_params)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Extract%20numeric%20load%20value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_numeric_for_params%20%3D%20float(load_for_params.replace(%22Load_%22%2C%20%22%22).replace(%22A%22%2C%20%22%22))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_values.add(load_numeric_for_params)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20sorted(wafer_names)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20sorted(channels)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20sorted(vout_values)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20sorted(cboot_values)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20sorted(load_values)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20return%20(extract_parameter_values_v10%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(extract_parameter_values_v10%2C%20tm_scope_collection_v10)%3A%0A%20%20%20%20%23%20Extract%20parameter%20values%20for%20dynamic%20button%20creation%20including%20wafer%20names%20(v10)%0A%20%20%20%20g_wafer_values%2C%20g_ch_values%2C%20g_vout_values%2C%20g_cboot_values%2C%20g_load_values%20%3D%20extract_parameter_values_v10(tm_scope_collection_v10)%0A%0A%20%20%20%20print(%22%F0%9F%93%8B%20Enhanced%20Parameter%20Extraction%20Results%20(v10)%3A%22)%0A%20%20%20%20print(f%22%20%20%20Wafer%20names%3A%20%7Bg_wafer_values%7D%22)%20%20%23%20NEW%20in%20v10%0A%20%20%20%20print(f%22%20%20%20Channels%3A%20%7Bg_ch_values%7D%22)%0A%20%20%20%20print(f%22%20%20%20VOUT%20values%3A%20%7Bg_vout_values%7D%22)%0A%20%20%20%20print(f%22%20%20%20CBOOT%20values%3A%20%7Bg_cboot_values%7D%22)%0A%20%20%20%20print(f%22%20%20%20Load%20values%3A%20%7Bg_load_values%7D%22)%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20g_cboot_values%2C%0A%20%20%20%20%20%20%20%20g_ch_values%2C%0A%20%20%20%20%20%20%20%20g_load_values%2C%0A%20%20%20%20%20%20%20%20g_vout_values%2C%0A%20%20%20%20%20%20%20%20g_wafer_values%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(%0A%20%20%20%20g_cboot_values%2C%0A%20%20%20%20g_ch_values%2C%0A%20%20%20%20g_load_values%2C%0A%20%20%20%20g_vout_values%2C%0A%20%20%20%20g_wafer_values%2C%0A%20%20%20%20mo%2C%0A)%3A%0A%20%20%20%20%23%20Create%20enhanced%20checkbox%20UI%20components%20with%20wafer%20selection%20(v10)%0A%20%20%20%20def%20create_checkbox_groups_v10(wafer_vals%2C%20ch_vals%2C%20vout_vals%2C%20cboot_vals%2C%20load_vals)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Create%20checkbox%20groups%20for%20each%20parameter%20category%20including%20wafer%20selection%20(v10)%22%22%22%0A%0A%20%20%20%20%20%20%20%20%23%20Wafer%20checkboxes%20(Wave1Wafer3_A0-V1%2C%20Wave2WaferX_A1-V1%2C%20etc.)%20-%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20if%20wafer_vals%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_wafer_checkboxes%20%3D%20mo.ui.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.checkbox(label%3Dwafer%2C%20value%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20wafer%20in%20wafer_vals%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_wafer_checkboxes%20%3D%20mo.ui.array(%5Bmo.ui.checkbox(label%3D%22No%20wafers%22%2C%20disabled%3DTrue)%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Channel%20checkboxes%20(SW%2C%20PH)%0A%20%20%20%20%20%20%20%20if%20ch_vals%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_ch_checkboxes%20%3D%20mo.ui.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.checkbox(label%3Dch%2C%20value%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20ch%20in%20ch_vals%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_ch_checkboxes%20%3D%20mo.ui.array(%5Bmo.ui.checkbox(label%3D%22No%20channels%22%2C%20disabled%3DTrue)%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20VOUT%20checkboxes%20(0.8V%2C%201.8V%2C%20etc.)%0A%20%20%20%20%20%20%20%20if%20vout_vals%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_vout_checkboxes%20%3D%20mo.ui.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.checkbox(label%3Df%22%7Bv%7DV%22%2C%20value%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20v%20in%20vout_vals%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_vout_checkboxes%20%3D%20mo.ui.array(%5Bmo.ui.checkbox(label%3D%22No%20VOUT%22%2C%20disabled%3DTrue)%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20CBOOT%20checkboxes%20(0.1%CE%BCF%2C%200.22%CE%BCF%2C%200.47%CE%BCF%2C%20etc.)%0A%20%20%20%20%20%20%20%20if%20cboot_vals%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_cboot_checkboxes%20%3D%20mo.ui.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.checkbox(label%3Df%22%7Bc%7D%CE%BCF%22%2C%20value%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20c%20in%20cboot_vals%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_cboot_checkboxes%20%3D%20mo.ui.array(%5Bmo.ui.checkbox(label%3D%22No%20CBOOT%22%2C%20disabled%3DTrue)%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20Load%20checkboxes%20(0A%2C%201A%2C%202A%2C%20...%2C%2070A)%0A%20%20%20%20%20%20%20%20if%20load_vals%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_load_checkboxes%20%3D%20mo.ui.array(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mo.ui.checkbox(label%3Df%22%7Bint(load)%7DA%22%2C%20value%3DFalse)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20load%20in%20load_vals%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20g_load_checkboxes%20%3D%20mo.ui.array(%5Bmo.ui.checkbox(label%3D%22No%20loads%22%2C%20disabled%3DTrue)%5D)%0A%0A%20%20%20%20%20%20%20%20return%20g_wafer_checkboxes%2C%20g_ch_checkboxes%2C%20g_vout_checkboxes%2C%20g_cboot_checkboxes%2C%20g_load_checkboxes%0A%0A%20%20%20%20%23%20Create%20enhanced%20checkbox%20groups%20with%20extracted%20values%20including%20wafer%20selection%0A%20%20%20%20g_wafer_checkboxes%2C%20g_ch_checkboxes%2C%20g_vout_checkboxes%2C%20g_cboot_checkboxes%2C%20g_load_checkboxes%20%3D%20create_checkbox_groups_v10(%0A%20%20%20%20%20%20%20%20g_wafer_values%2C%20g_ch_values%2C%20g_vout_values%2C%20g_cboot_values%2C%20g_load_values%0A%20%20%20%20)%0A%0A%20%20%20%20def%20create_load_rows(load_checkboxes%2C%20max_per_row%3D10)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Break%20load%20checkboxes%20into%20multiple%20rows%22%22%22%0A%20%20%20%20%20%20%20%20if%20len(load_checkboxes)%20%3C%3D%20max_per_row%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20mo.hstack(load_checkboxes%2C%20gap%3D1)%0A%0A%20%20%20%20%20%20%20%20rows%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(0%2C%20len(load_checkboxes)%2C%20max_per_row)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20row_checkboxes%20%3D%20load_checkboxes%5Bi%3Ai%20%2B%20max_per_row%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20rows.append(mo.hstack(row_checkboxes%2C%20gap%3D1))%0A%0A%20%20%20%20%20%20%20%20return%20mo.vstack(rows%2C%20gap%3D1)%0A%0A%20%20%20%20%23%20Create%20enhanced%20organized%20checkbox%20panel%20layout%20with%20wafer%20row%0A%20%20%20%20g_checkbox_panel_v10%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20%F0%9F%8E%9B%EF%B8%8F%20Trace%20Selection%20Controls%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22*Check%20parameters%20to%20filter%20displayed%20traces.%20Checked%20items%20are%20selected.%20Multiple%20selections%20are%20additive.*%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5Bmo.md(%22**Wafer%3A**%22)%2C%20mo.hstack(g_wafer_checkboxes%2C%20gap%3D2)%5D%2C%20gap%3D1)%2C%20%20%23%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5Bmo.md(%22**Channel%3A**%22)%2C%20mo.hstack(g_ch_checkboxes%2C%20gap%3D2)%5D%2C%20gap%3D1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5Bmo.md(%22**VOUT%3A**%22)%2C%20mo.hstack(g_vout_checkboxes%2C%20gap%3D2)%5D%2C%20gap%3D1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5Bmo.md(%22**CBOOT%3A**%22)%2C%20mo.hstack(g_cboot_checkboxes%2C%20gap%3D2)%5D%2C%20gap%3D1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%23mo.vstack(%5Bmo.md(%22**LOAD%3A**%22)%2C%20mo.hstack(g_load_checkboxes%2C%20gap%3D2)%5D%2C%20gap%3D1)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.vstack(%5Bmo.md(%22**LOAD%3A**%22)%2C%20create_load_rows(g_load_checkboxes%2C%2013)%5D%2C%20gap%3D1)%0A%20%20%20%20%20%20%20%20%5D%2C%20gap%3D3)%0A%20%20%20%20%5D)%0A%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20g_cboot_checkboxes%2C%0A%20%20%20%20%20%20%20%20g_ch_checkboxes%2C%0A%20%20%20%20%20%20%20%20g_checkbox_panel_v10%2C%0A%20%20%20%20%20%20%20%20g_load_checkboxes%2C%0A%20%20%20%20%20%20%20%20g_vout_checkboxes%2C%0A%20%20%20%20%20%20%20%20g_wafer_checkboxes%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(%0A%20%20%20%20g_cboot_checkboxes%2C%0A%20%20%20%20g_cboot_values%2C%0A%20%20%20%20g_ch_checkboxes%2C%0A%20%20%20%20g_ch_values%2C%0A%20%20%20%20g_load_checkboxes%2C%0A%20%20%20%20g_load_values%2C%0A%20%20%20%20g_vout_checkboxes%2C%0A%20%20%20%20g_vout_values%2C%0A%20%20%20%20g_wafer_checkboxes%2C%0A%20%20%20%20g_wafer_values%2C%0A)%3A%0A%20%20%20%20%23%20Process%20enhanced%20checkbox%20states%20including%20wafer%20selection%20(v10)%0A%20%20%20%20def%20extract_selected_values_from_checkboxes_v10(checkbox_array%2C%20value_list)%3A%0A%20%20%20%20%20%20%20%20%22%22%22Extract%20selected%20values%20from%20checkbox%20array%20states%20-%20fixed%20UIElement%20evaluation%20(v10)%22%22%22%0A%20%20%20%20%20%20%20%20%23%20Check%20if%20arrays%20exist%20and%20have%20content%20(avoid%20UIElement%20boolean%20evaluation)%0A%20%20%20%20%20%20%20%20if%20checkbox_array%20is%20None%20or%20value_list%20is%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%5B%5D%0A%20%20%20%20%20%20%20%20if%20len(checkbox_array)%20%3D%3D%200%20or%20len(value_list)%20%3D%3D%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20selected%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20i%2C%20checkbox%20in%20enumerate(checkbox_array)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Only%20check%20.value%20property%20-%20avoid%20UIElement%20boolean%20evaluation%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20i%20%3C%20len(value_list)%20and%20checkbox.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20selected.append(value_list%5Bi%5D)%0A%20%20%20%20%20%20%20%20return%20selected%0A%0A%20%20%20%20%23%20Extract%20current%20selections%20from%20checkboxes%20including%20wafer%20selection%0A%20%20%20%20g_selected_wafers%20%3D%20extract_selected_values_from_checkboxes_v10(g_wafer_checkboxes%2C%20g_wafer_values)%20%20%23%20NEW%20in%20v10%0A%20%20%20%20g_selected_channels%20%3D%20extract_selected_values_from_checkboxes_v10(g_ch_checkboxes%2C%20g_ch_values)%0A%20%20%20%20g_selected_vout%20%3D%20extract_selected_values_from_checkboxes_v10(g_vout_checkboxes%2C%20g_vout_values)%0A%20%20%20%20g_selected_cboot%20%3D%20extract_selected_values_from_checkboxes_v10(g_cboot_checkboxes%2C%20g_cboot_values)%0A%20%20%20%20g_selected_loads%20%3D%20extract_selected_values_from_checkboxes_v10(g_load_checkboxes%2C%20g_load_values)%0A%0A%20%20%20%20%23%20Create%20enhanced%20selection%20state%20dictionary%20with%20wafer%20selection%0A%20%20%20%20g_selection_state_v10%20%3D%20%7B%0A%20%20%20%20%20%20%20%20%22wafers%22%3A%20g_selected_wafers%2C%20%20%20%20%20%23%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20%22channels%22%3A%20g_selected_channels%2C%0A%20%20%20%20%20%20%20%20%22vout%22%3A%20g_selected_vout%2C%0A%20%20%20%20%20%20%20%20%22cboot%22%3A%20g_selected_cboot%2C%0A%20%20%20%20%20%20%20%20%22loads%22%3A%20g_selected_loads%2C%0A%20%20%20%20%20%20%20%20%22any_selected%22%3A%20len(g_selected_wafers)%20%3E%200%20or%20len(g_selected_channels)%20%3E%200%20or%20len(g_selected_vout)%20%3E%200%20or%20len(g_selected_cboot)%20%3E%200%20or%20len(g_selected_loads)%20%3E%200%0A%20%20%20%20%7D%0A%0A%20%20%20%20%23%20Display%20current%20selections%20for%20debugging%0A%20%20%20%20if%20g_selection_state_v10%5B%22any_selected%22%5D%3A%0A%20%20%20%20%20%20%20%20print(%22%F0%9F%8E%AF%20Current%20Enhanced%20Checkbox%20Selections%20(v10)%3A%22)%0A%20%20%20%20%20%20%20%20if%20g_selected_wafers%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Wafers%3A%20%7Bg_selected_wafers%7D%22)%20%20%23%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20if%20g_selected_channels%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Channels%3A%20%7Bg_selected_channels%7D%22)%0A%20%20%20%20%20%20%20%20if%20g_selected_vout%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20VOUT%3A%20%7Bg_selected_vout%7D%22)%0A%20%20%20%20%20%20%20%20if%20g_selected_cboot%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20CBOOT%3A%20%7Bg_selected_cboot%7D%22)%0A%20%20%20%20%20%20%20%20if%20g_selected_loads%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%20Load%3A%20%7Bg_selected_loads%7D%22)%0A%0A%20%20%20%20return%20(g_selection_state_v10%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(Dict%2C%20FigureWidgetResampler%2C%20TMScopeDataCollection%2C%20go%2C%20pc)%3A%0A%20%20%20%20%23%20Enhanced%20Plotly%20Visualization%20Functions%20with%20Wafer%20Support%20%2B%20Push-Button%20Filtering%20(v10)%0A%0A%20%20%20%20def%20create_detailed_trace_name_v10(wafer%3A%20str%2C%20vout%3A%20float%2C%20cboot%3A%20float%2C%20channel%3A%20str%2C%20load_name%3A%20str)%20-%3E%20str%3A%0A%20%20%20%20%20%20%20%20%22%22%22Create%20clear%2C%20descriptive%20trace%20names%20including%20wafer%20information%20(v10)%22%22%22%0A%20%20%20%20%20%20%20%20%23%20Extract%20numeric%20load%20value%20for%20sorting%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20load_numeric%20%3D%20float(load_name.replace(%22Load_%22%2C%20%22%22).replace(%22A%22%2C%20%22%22))%0A%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20load_numeric%20%3D%200%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20hierarchical%20name%20with%20wafer%20prefix%20(v10%20enhancement)%0A%20%20%20%20%20%20%20%20return%20f%22%7Bwafer%7D_%7Bvout%7DV_%7Bcboot%7D%CE%BCF_%7Bchannel%7D_%7Bload_numeric%3Ag%7DA%22%0A%0A%20%20%20%20def%20should_include_trace_v10(wafer%3A%20str%2C%20vout%3A%20float%2C%20cboot%3A%20float%2C%20channel%3A%20str%2C%20load_name%3A%20str%2C%20selection_filters%3A%20Dict)%20-%3E%20bool%3A%0A%20%20%20%20%20%20%20%20%22%22%22Determine%20if%20trace%20should%20be%20included%20based%20on%20button%20selections%20including%20wafer%20(v10)%22%22%22%0A%20%20%20%20%20%20%20%20if%20not%20selection_filters%20or%20not%20selection_filters.get(%22any_selected%22%2C%20False)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20True%20%20%23%20Show%20all%20traces%20if%20no%20filters%20selected%0A%0A%20%20%20%20%20%20%20%20%23%20Extract%20numeric%20load%20for%20comparison%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20load_numeric%20%3D%20float(load_name.replace(%22Load_%22%2C%20%22%22).replace(%22A%22%2C%20%22%22))%0A%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20%20%20%20%20%23%20Check%20each%20filter%20category%20-%20if%20category%20has%20selections%2C%20trace%20must%20match%20at%20least%20one%0A%20%20%20%20%20%20%20%20filters_to_check%20%3D%20%5B%5D%0A%0A%20%20%20%20%20%20%20%20if%20selection_filters.get(%22wafers%22)%3A%20%20%20%20%20%20%20%20%20%20%23%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20%20%20%20%20filters_to_check.append(wafer%20in%20selection_filters%5B%22wafers%22%5D)%0A%0A%20%20%20%20%20%20%20%20if%20selection_filters.get(%22channels%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20filters_to_check.append(channel%20in%20selection_filters%5B%22channels%22%5D)%0A%0A%20%20%20%20%20%20%20%20if%20selection_filters.get(%22vout%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20filters_to_check.append(vout%20in%20selection_filters%5B%22vout%22%5D)%0A%0A%20%20%20%20%20%20%20%20if%20selection_filters.get(%22cboot%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20filters_to_check.append(cboot%20in%20selection_filters%5B%22cboot%22%5D)%0A%0A%20%20%20%20%20%20%20%20if%20selection_filters.get(%22loads%22)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20filters_to_check.append(load_numeric%20in%20selection_filters%5B%22loads%22%5D)%0A%0A%20%20%20%20%20%20%20%20%23%20If%20any%20filter%20categories%20are%20selected%2C%20trace%20must%20match%20ALL%20selected%20categories%0A%20%20%20%20%20%20%20%20return%20all(filters_to_check)%20if%20filters_to_check%20else%20True%0A%0A%20%20%20%20def%20configure_individual_trace_legend_v10(fig%3A%20FigureWidgetResampler)%20-%3E%20FigureWidgetResampler%3A%0A%20%20%20%20%20%20%20%20%22%22%22Configure%20legend%20for%20individual%20trace%20control%20with%20wafer%20support%20(v10)%22%22%22%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20legend%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3D%22Individual%20Traces%20(v10)%3Cbr%3E%3Ci%3EClick%20to%20show%2Fhide%20each%20trace%3Cbr%3EFormat%3A%20WAFER_VOUT_CBOOT_CH_LOAD%3C%2Fi%3E%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font%3Ddict(size%3D12%2C%20color%3D%22black%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20orientation%3D%22v%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yanchor%3D%22top%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D0.98%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xanchor%3D%22left%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D1.02%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bgcolor%3D%22rgba(255%2C255%2C255%2C0.95)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bordercolor%3D%22rgba(0%2C0%2C0%2C0.3)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20borderwidth%3D1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font%3Ddict(size%3D9)%2C%20%20%23%20Smaller%20font%20for%20many%20individual%20entries%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20itemsizing%3D%22constant%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20itemwidth%3D30%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Allow%20scrolling%20for%20large%20numbers%20of%20traces%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20itemclick%3D%22toggle%22%2C%20%20%23%20Standard%20individual%20toggle%20behavior%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20itemdoubleclick%3D%22toggleothers%22%20%20%23%20Double-click%20to%20isolate%20trace%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20def%20apply_smart_default_visibility_v10(fig%3A%20FigureWidgetResampler%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collection%3A%20TMScopeDataCollection%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20selection_filters%3A%20Dict%20%3D%20None)%20-%3E%20FigureWidgetResampler%3A%0A%20%20%20%20%20%20%20%20%22%22%22Apply%20intelligent%20default%20visibility%20for%20datasets%20with%20many%20traces%20including%20wafer%20filtering%20(v10)%22%22%22%0A%0A%20%20%20%20%20%20%20%20total_traces%20%3D%20len(fig.data)%0A%0A%20%20%20%20%20%20%20%20%23%20If%20button%20filters%20are%20active%2C%20show%20all%20matching%20traces%0A%20%20%20%20%20%20%20%20if%20selection_filters%20and%20selection_filters.get(%22any_selected%22%2C%20False)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%8E%AF%20Enhanced%20button%20filters%20active%20(v10)%20-%20showing%20%7Bsum(1%20for%20trace%20in%20fig.data%20if%20trace.visible)%7D%20filtered%20traces%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20%20%20%20%20if%20total_traces%20%3E%2030%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Show%20only%20representative%20load%20conditions%20by%20default%0A%20%20%20%20%20%20%20%20%20%20%20%20representative_loads%20%3D%20%5B'0A'%2C%20'10A'%2C%20'20A'%2C%20'40A'%2C%20'60A'%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20trace%20in%20fig.data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Check%20if%20this%20trace%20represents%20a%20representative%20load%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20trace_is_representative%20%3D%20any(f%22_%7Bload%7D%22%20in%20trace.name%20for%20load%20in%20representative_loads)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20trace.visible%20%3D%20trace_is_representative%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%93%8A%20Large%20dataset%20detected%20(%7Btotal_traces%7D%20traces)%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%F0%9F%8E%AF%20Showing%20representative%20loads%20by%20default%3A%20%7Brepresentative_loads%7D%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%22%F0%9F%92%A1%20Use%20enhanced%20button%20controls%2C%20bulk%20controls%20or%20legend%20to%20show%20additional%20traces%22)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20def%20create_enhanced_resampled_plot_v10(collection%3A%20TMScopeDataCollection%2C%20selection_filters%3A%20Dict%20%3D%20None)%20-%3E%20FigureWidgetResampler%3A%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20Enhanced%20resampled%20waveform%20plot%20with%20wafer%20support%20%2B%20push-button%20filtering%20(v10)%0A%0A%20%20%20%20%20%20%20%20v10%20Features%3A%0A%20%20%20%20%20%20%20%20-%20Wafer%20selection%3A%20Filter%20traces%20by%20wafer%20type%20(Wave1Wafer3_A0-V1%2C%20Wave2WaferX_A1-V1%2C%20etc.)%0A%20%20%20%20%20%20%20%20-%20Enhanced%20push-button%20filtering%3A%20Filter%20traces%20by%20WAFER%2C%20CH%2C%20VOUT%2C%20CBOOT%2C%20LOAD%0A%20%20%20%20%20%20%20%20-%20Individual%20trace%20legend%20control%20(each%20load%20condition%20selectable)%0A%20%20%20%20%20%20%20%20-%20Bulk%20selection%20via%20updatemenus%20(WAFER%2C%20VOUT%2C%20CBOOT%2C%20Channel)%0A%20%20%20%20%20%20%20%20-%20Smart%20defaults%20for%20large%20datasets%0A%20%20%20%20%20%20%20%20-%20Enhanced%20trace%20naming%20with%20wafer%20identifier%0A%0A%20%20%20%20%20%20%20%20Features%3A%0A%20%20%20%20%20%20%20%20-%20Single%20plot%20shows%20all%20data%20from%20collection%20across%20all%20wafers%0A%20%20%20%20%20%20%20%20-%20Individual%20trace%20control%3A%20Each%20load%20condition%20independently%20selectable%0A%20%20%20%20%20%20%20%20-%20Bulk%20selection%20controls%3A%20WAFER%2C%20VOUT%2C%20CBOOT%2C%20Channel%20level%20filtering%0A%20%20%20%20%20%20%20%20-%20Intensity-based%20coloring%3A%20workbook%20color%20%2B%20load%20intensity%0A%20%20%20%20%20%20%20%20-%20Zoom-to-detail%3A%20Full%20resolution%20data%20when%20zoomed%20in%0A%20%20%20%20%20%20%20%20-%20Smart%20defaults%3A%20Representative%20traces%20shown%20for%20large%20datasets%0A%20%20%20%20%20%20%20%20%22%22%22%0A%0A%20%20%20%20%20%20%20%20if%20not%20collection.data%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Return%20empty%20plot%20if%20no%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20fig%20%3D%20FigureWidgetResampler(go.Figure())%0A%20%20%20%20%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22No%20tm_scope%20data%20available%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D%22Time%20(s)%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D%22Voltage%20(V)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3D600%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20%20%20%20%20%23%20Create%20resampler-enabled%20figure%0A%20%20%20%20%20%20%20%20fig%20%3D%20FigureWidgetResampler(go.Figure())%0A%0A%20%20%20%20%20%20%20%20%23%20Performance%20tracking%0A%20%20%20%20%20%20%20%20total_traces%20%3D%200%0A%20%20%20%20%20%20%20%20filtered_traces%20%3D%200%0A%0A%20%20%20%20%20%20%20%20%23%20Base%20colors%20for%20different%20workbooks%20(WAFER%2FVOUT%2FCBOOT%20combinations)%0A%20%20%20%20%20%20%20%20base_colors%20%3D%20%5B%22blue%22%2C%20%22red%22%2C%20%22green%22%2C%20%22orange%22%2C%20%22purple%22%2C%20%22brown%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22pink%22%2C%20%22gray%22%2C%20%22olive%22%2C%20%22cyan%22%2C%20%22magenta%22%2C%20%22yellow%22%5D%0A%0A%20%20%20%20%20%20%20%20%23%20Get%20all%20available%20loads%20and%20normalize%20for%20intensity%20mapping%0A%20%20%20%20%20%20%20%20all_loads_numeric%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20for%20wafer_for_loads%20in%20collection.get_available_wafer_names()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_for_loads%20in%20collection.get_available_vout_values(wafer_for_loads)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_for_loads%20in%20collection.get_available_cboot_values(wafer_for_loads%2C%20vout_for_loads)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20channel_for_loads%20in%20collection.get_available_channels(wafer_for_loads%2C%20vout_for_loads%2C%20cboot_for_loads)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20load_name_for_loads%20in%20collection.get_available_loads(wafer_for_loads%2C%20vout_for_loads%2C%20cboot_for_loads%2C%20channel_for_loads)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_numeric_for_loads%20%3D%20float(load_name_for_loads.replace(%22Load_%22%2C%20%22%22).replace(%22A%22%2C%20%22%22))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20all_loads_numeric.append(load_numeric_for_loads)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%0A%0A%20%20%20%20%20%20%20%20min_load%20%3D%20min(all_loads_numeric)%20if%20all_loads_numeric%20else%200%0A%20%20%20%20%20%20%20%20max_load%20%3D%20max(all_loads_numeric)%20if%20all_loads_numeric%20else%20100%0A%0A%20%20%20%20%20%20%20%20%23%20Add%20traces%20to%20the%20plot%20(with%20enhanced%20filtering%20including%20wafer)%0A%20%20%20%20%20%20%20%20workbook_index%20%3D%200%0A%20%20%20%20%20%20%20%20for%20wafer_for_plot%20in%20collection.get_available_wafer_names()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20vout_for_plot%20in%20collection.get_available_vout_values(wafer_for_plot)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20cboot_for_plot%20in%20collection.get_available_cboot_values(wafer_for_plot%2C%20vout_for_plot)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Assign%20base%20color%20for%20this%20workbook%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20base_color%20%3D%20base_colors%5Bworkbook_index%20%25%20len(base_colors)%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20workbook_index%20%2B%3D%201%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Get%20shared%20time%20base%20for%20this%20workbook%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20time_data%20%3D%20collection.time_base%5Bwafer_for_plot%5D%5Bvout_for_plot%5D%5Bcboot_for_plot%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20channel_for_plot%20in%20collection.get_available_channels(wafer_for_plot%2C%20vout_for_plot%2C%20cboot_for_plot)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20load_name_for_plot%2C%20voltage_series%20in%20collection.data%5Bwafer_for_plot%5D%5Bvout_for_plot%5D%5Bcboot_for_plot%5D%5Bchannel_for_plot%5D.items()%3A%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20total_traces%20%2B%3D%201%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Apply%20enhanced%20push-button%20filtering%20including%20wafer%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20not%20should_include_trace_v10(wafer_for_plot%2C%20vout_for_plot%2C%20cboot_for_plot%2C%20channel_for_plot%2C%20load_name_for_plot%2C%20selection_filters)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%20%20%23%20Skip%20this%20trace%20based%20on%20button%20filters%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20filtered_traces%20%2B%3D%201%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Calculate%20color%20intensity%20based%20on%20load%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20load_numeric_for_plot%20%3D%20float(load_name_for_plot.replace(%22Load_%22%2C%20%22%22).replace(%22A%22%2C%20%22%22))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20max_load%20%3E%20min_load%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20intensity%20%3D%200.3%20%2B%200.7%20*%20(load_numeric_for_plot%20-%20min_load)%20%2F%20(max_load%20-%20min_load)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20intensity%20%3D%201.0%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20except%20ValueError%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20intensity%20%3D%201.0%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Create%20intensity-adjusted%20color%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20hasattr(pc.qualitative%2C%20'Plotly')%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color_palette%20%3D%20pc.qualitative.Plotly%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color_palette%20%3D%20%5B'%23636EFA'%2C%20'%23EF553B'%2C%20'%2300CC96'%2C%20'%23AB63FA'%2C%20'%23FFA15A'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'%2319D3F3'%2C%20'%23FF6692'%2C%20'%23B6E880'%2C%20'%23FF97FF'%2C%20'%23FECB52'%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20base_color_hex%20%3D%20color_palette%5Bbase_colors.index(base_color)%20%25%20len(color_palette)%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Convert%20hex%20to%20RGB%20for%20intensity%20adjustment%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hex_color%20%3D%20base_color_hex.lstrip('%23')%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20rgb_color%20%3D%20tuple(int(hex_color%5Bi%3Ai%2B2%5D%2C%2016)%20for%20i%20in%20(0%2C%202%2C%204))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20adjusted_color%20%3D%20f%22rgba(%7Brgb_color%5B0%5D%7D%2C%7Brgb_color%5B1%5D%7D%2C%7Brgb_color%5B2%5D%7D%2C%7Bintensity%7D)%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Create%20enhanced%20trace%20name%20including%20wafer%20information%20(v10)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20trace_name%20%3D%20create_detailed_trace_name_v10(wafer_for_plot%2C%20vout_for_plot%2C%20cboot_for_plot%2C%20channel_for_plot%2C%20load_name_for_plot)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20Add%20trace%20with%20individual%20control%20(NO%20legendgroup)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fig.add_trace(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20go.Scattergl(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mode%3D'lines'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20name%3Dtrace_name%2C%20%20%23%20Individual%20legend%20entry%20with%20wafer%20info%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20line%3Ddict(color%3Dadjusted_color%2C%20width%3D1.5)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20NO%20legendgroup%20%3D%20individual%20control%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hovertemplate%3D(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f'%3Cb%3EWafer%3A%20%7Bwafer_for_plot%7D%3C%2Fb%3E%3Cbr%3E'%20%20%23%20NEW%20in%20v10%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f'%3Cb%3EVOUT%3A%20%7Bvout_for_plot%7DV%2C%20CBOOT%3A%20%7Bcboot_for_plot%7D%CE%BCF%3C%2Fb%3E%3Cbr%3E'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f'Channel%3A%20%7Bchannel_for_plot%7D%3Cbr%3E'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20f'Load%3A%20%7Bload_name_for_plot%7D%3Cbr%3E'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'Time%3A%20%25%7Bx%7Ds%3Cbr%3E'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'Voltage%3A%20%25%7By%7DV%3Cextra%3E%3C%2Fextra%3E'%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20visible%3DTrue%20%20%23%20Will%20be%20adjusted%20by%20smart%20defaults%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hf_x%3Dtime_data%2C%20%20%20%20%20%20%23%20High-frequency%20x%20data%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20hf_y%3Dvoltage_series%20%20%23%20High-frequency%20y%20data%20-%20auto-resampled!%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Configure%20layout%20with%20enhanced%20individual%20legend%20(bulk%20controls%20replaced%20by%20checkboxes)%0A%20%20%20%20%20%20%20%20filter_info%20%3D%20%22%22%0A%20%20%20%20%20%20%20%20if%20selection_filters%20and%20selection_filters.get(%22any_selected%22%2C%20False)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20filter_info%20%3D%20f%22%20%7C%20%7Bfiltered_traces%7D%2F%7Btotal_traces%7D%20traces%22%0A%0A%20%20%20%20%20%20%20%20fig.update_layout(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Ddict(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%3Df%22Interactive%20Waveform%20Viewer%20%7Bfilter_info%7D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3D0.5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3D0.95%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20font%3Ddict(size%3D14)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xaxis_title%3D%22Time%20(s)%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yaxis_title%3D%22Voltage%20(V)%22%2C%20%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20margin%3Ddict(t%3D80%2C%20r%3D300%2C%20b%3D80%2C%20l%3D80)%2C%20%20%23%20Slightly%20larger%20right%20margin%20for%20enhanced%20legend%0A%20%20%20%20%20%20%20%20%20%20%20%20hovermode%3D'x%20unified'%0A%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%23%20Configure%20enhanced%20individual%20trace%20legend%0A%20%20%20%20%20%20%20%20fig%20%3D%20configure_individual_trace_legend_v10(fig)%0A%0A%20%20%20%20%20%20%20%20%23%20Apply%20smart%20defaults%20for%20large%20datasets%20(respects%20enhanced%20button%20filtering)%0A%20%20%20%20%20%20%20%20fig%20%3D%20apply_smart_default_visibility_v10(fig%2C%20collection%2C%20selection_filters)%0A%0A%20%20%20%20%20%20%20%20print(f%22%F0%9F%93%8A%20Created%20interactive%20plot%20with%20%7Bfiltered_traces%7D%20traces%20(from%20%7Btotal_traces%7D%20total)%22)%0A%20%20%20%20%20%20%20%20print(f%22%F0%9F%94%84%20Individual%20trace%20control%3A%20Click%20legend%20entries%22)%0A%20%20%20%20%20%20%20%20print(f%22%F0%9F%8E%9B%EF%B8%8F%20Enhanced%20checkbox%20filtering%3A%20Use%20checkboxes%20above%20plot%20for%20precise%20wafer%20%2B%20parameter%20selection%22)%0A%20%20%20%20%20%20%20%20print(f%22%F0%9F%94%8D%20Zoom%20in%20for%20full%20resolution%2C%20%5BR%5D%20indicators%20show%20resampled%20traces%22)%0A%0A%20%20%20%20%20%20%20%20return%20fig%0A%0A%20%20%20%20return%20(create_enhanced_resampled_plot_v10%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(%0A%20%20%20%20create_enhanced_resampled_plot_v10%2C%0A%20%20%20%20g_selection_state_v10%2C%0A%20%20%20%20tm_scope_collection_v10%2C%0A)%3A%0A%20%20%20%20%23%20Create%20the%20enhanced%20resampled%20waveform%20plot%20with%20wafer%20support%20%2B%20push-button%20filtering%20(v10)%0A%20%20%20%20print(%22%F0%9F%94%84%20Creating%20enhanced%20waveform%20visualization%20with%20wafer%20support%20%2B%20push-button%20filtering%20(v10)...%22)%0A%0A%20%20%20%20g_enhanced_plot_v10%20%3D%20create_enhanced_resampled_plot_v10(%0A%20%20%20%20%20%20%20%20tm_scope_collection_v10%2C%20%0A%20%20%20%20%20%20%20%20selection_filters%3Dg_selection_state_v10%0A%20%20%20%20)%0A%0A%20%20%20%20if%20tm_scope_collection_v10.data%3A%0A%20%20%20%20%20%20%20%20print(%22%E2%9C%85%20Enhanced%20plot%20v10%20created%20successfully!%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%A7%AC%20Wafer%20selection%3A%20Filter%20by%20wafer%20type%20(Wave1Wafer3_A0-V1%2C%20Wave2WaferX_A1-V1%2C%20etc.)%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%8E%9B%EF%B8%8F%20Enhanced%20push-button%20filtering%3A%20Select%20WAFER%20%2B%20parameters%20to%20filter%20traces%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%93%8A%20Individual%20trace%20control%3A%20Each%20load%20condition%20selectable%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%93%8B%20Enhanced%20trace%20naming%3A%20Includes%20wafer%20identifier%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%94%84%20Automatic%20aggregation%20enabled%20(plotly-resampler)%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%94%8D%20Zoom%20in%20for%20full%20resolution%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%5BR%5D%20indicators%20show%20resampled%20traces%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%8E%AF%20Smart%20defaults%20for%20large%20datasets%22)%0A%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%92%BE%20Memory%20optimized%3A%20%3C10MB%20output%22)%0A%0A%20%20%20%20%20%20%20%20if%20g_selection_state_v10.get(%22any_selected%22%2C%20False)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(%22%20%20%20%F0%9F%8E%AF%20Enhanced%20button%20filters%20currently%20active%20(v10)%22)%0A%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20print(%22%E2%9A%A0%EF%B8%8F%20No%20data%20available%20for%20visualization%22)%0A%0A%20%20%20%20return%20(g_enhanced_plot_v10%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(g_checkbox_panel_v10%2C%20g_enhanced_plot_v10%2C%20mo)%3A%0A%20%20%20%20%23%20Display%20the%20enhanced%20visualization%20UI%20with%20wafer%20checkbox%20controls%20positioned%20above%20plot%20(v10)%0A%20%20%20%20g_visualization_ui_v10%20%3D%20mo.vstack(%5B%0A%20%20%20%20%20%20%20%20mo.md(%22%23%23%23%20%F0%9F%8E%A8%20plotly_resampler.FigureResampler%20Waveform%20Visualization%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%20%20%20%20-%20**Wafer%20Checkbox%20Control%3A**%20Select%20specific%20wafer%20types%20for%20analysis%0A%20%20%20%20%20%20%20%20-%20**Enhanced%20Dynamic%20Checkboxes%3A**%20WAFER%2C%20CH%2C%20VOUT%2C%20CBOOT%2C%20LOAD%20parameters%20populated%20from%20scope%20data%20extraction%0A%20%20%20%20%20%20%20%20-%20**Independent%20Selection%3A**%20Each%20checkbox%20operates%20independently%20%20%0A%20%20%20%20%20%20%20%20-%20**Additive%20Filtering%3A**%20Multiple%20selections%20show%20multiple%20traces%20(e.g.%2C%20Wave2WaferX_A1-V1%20%2B%20SW%20%2B%200.8V)%0A%20%20%20%20%20%20%20%20-%20**Unlimited%20Data%3A**%20Handles%207.5M%2B%20data%20points%20without%20issue%0A%0A%20%20%20%20%20%20%20%20-%20**Checkboxes%20(below)%3A**%20Check%20WAFER%20%2B%20parameters%20to%20filter%20displayed%20traces%0A%20%20%20%20%20%20%20%20-%20**Legend%20(right)%3A**%20Click%20traces%20to%20show%2Fhide%20individual%20waveforms%20with%20wafer%20info%0A%20%20%20%20%20%20%20%20-%20**Hover%3A**%20View%20detailed%20information%20including%20wafer%20identification%0A%20%20%20%20%20%20%20%20-%20**Zoom%2FPan%3A**%20Use%20mouse%20to%20explore%20waveform%20details%20(auto-loads%20full%20resolution)%0A%20%20%20%20%20%20%20%20%22%22%22)%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20g_checkbox_panel_v10%2C%0A%20%20%20%20%20%20%20%20mo.md(%22---%22)%2C%0A%20%20%20%20%20%20%20%20g_enhanced_plot_v10%0A%20%20%20%20%5D)%0A%0A%20%20%20%20return%20(g_visualization_ui_v10%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(g_visualization_ui_v10)%3A%0A%20%20%20%20%23%20Display%20the%20final%20enhanced%20visualization%20with%20wafer%20support%20(v10)%0A%20%20%20%20g_visualization_ui_v10%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20Suppress%20large%20outputs%20-%20all%20enhanced%20data%20processing%20complete%20(v10)%0A%20%20%20%20pass%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "notebook.py",
            "mode": "read",
            "version": "0.14.6",
            "serverToken": "unused",
            "config": {"completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_page_size": 20, "default_width": "full", "theme": "system"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"layout_file": "data:application/json;base64,ew0KICAidHlwZSI6ICJncmlkIiwNCiAgImRhdGEiOiB7DQogICAgImNvbHVtbnMiOiA2LA0KICAgICJyb3dIZWlnaHQiOiAyMCwNCiAgICAibWF4V2lkdGgiOiAyNTAwLA0KICAgICJib3JkZXJlZCI6IHRydWUsDQogICAgImNlbGxzIjogWw0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBudWxsDQogICAgICB9LA0KICAgICAgew0KICAgICAgICAicG9zaXRpb24iOiBbDQogICAgICAgICAgMCwNCiAgICAgICAgICAwLA0KICAgICAgICAgIDYsDQogICAgICAgICAgMTUyDQogICAgICAgIF0sDQogICAgICAgICJzY3JvbGxhYmxlIjogdHJ1ZQ0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgInBvc2l0aW9uIjogbnVsbA0KICAgICAgfQ0KICAgIF0NCiAgfQ0KfQ==", "sql_output": "auto", "width": "columns"},
            "view": {"showAppCode": false},
            "notebook": null,
            "session": null,
            "runtimeConfig": null,
        };
    </script>
  </body>
</html>
